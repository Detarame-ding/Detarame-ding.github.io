<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="R;Seurat Package">
<title>åŸºäºSeuratåŒ…çš„å•ç»†èƒåˆ†ææ ‡å‡†æµç¨‹</title>

<link rel='canonical' href='https://Detarame-ding.github.io/p/none/'>

<link rel="stylesheet" href="/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css"><meta property='og:title' content="åŸºäºSeuratåŒ…çš„å•ç»†èƒåˆ†ææ ‡å‡†æµç¨‹">
<meta property='og:description' content="R;Seurat Package">
<meta property='og:url' content='https://Detarame-ding.github.io/p/none/'>
<meta property='og:site_name' content='é³•é±¼-Detarame'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2024-12-13T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2024-12-13T00:00:00&#43;00:00'/><meta property='og:image' content='https://Detarame-ding.github.io/p/none/seurat_banner.jpg' />
<meta name="twitter:title" content="åŸºäºSeuratåŒ…çš„å•ç»†èƒåˆ†ææ ‡å‡†æµç¨‹">
<meta name="twitter:description" content="R;Seurat Package"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://Detarame-ding.github.io/p/none/seurat_banner.jpg' />
    <link rel="shortcut icon" href="/favicon.ico" />

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="åˆ‡æ¢èœå•">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/OIP_hu8127449034170590479.jpg" width="300"
                            height="298" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ğŸ˜Š</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">é³•é±¼-Detarame</a></h1>
            <h2 class="site-description"></h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://github.com/CaiJimmy/hugo-theme-stack'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://twitter.com'
                        target="_blank"
                        title="Twitter"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>ä¸»é¡µ</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%85%B3%E4%BA%8E/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>å…³äº</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        
        
        <li >
            <a href='/links/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>Links</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>æš—è‰²æ¨¡å¼</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ç›®å½•</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#æ•°æ®é›†çš„å‡†å¤‡">æ•°æ®é›†çš„å‡†å¤‡</a>
      <ol>
        <li><a href="#è¯´æ˜">è¯´æ˜</a></li>
        <li><a href="#ä»£ç ">ä»£ç </a></li>
      </ol>
    </li>
    <li><a href="#è¯»å–æ•°æ®å¹¶æ„å»ºseuratå¯¹è±¡">è¯»å–æ•°æ®å¹¶æ„å»ºSeuratå¯¹è±¡</a>
      <ol>
        <li><a href="#è¯´æ˜-1">è¯´æ˜</a></li>
        <li><a href="#ä»£ç -1">ä»£ç </a></li>
        <li><a href="#å›¾ç‰‡">å›¾ç‰‡</a></li>
      </ol>
    </li>
    <li><a href="#è´¨é‡æ§åˆ¶">è´¨é‡æ§åˆ¶</a>
      <ol>
        <li><a href="#è¯´æ˜-2">è¯´æ˜</a></li>
        <li><a href="#ä»£ç -2">ä»£ç </a></li>
        <li><a href="#å›¾ç‰‡-1">å›¾ç‰‡</a></li>
      </ol>
    </li>
    <li><a href="#æ•°æ®é™ç»´">æ•°æ®é™ç»´</a>
      <ol>
        <li><a href="#è¯´æ˜-3">è¯´æ˜</a></li>
        <li><a href="#ä»£ç -3">ä»£ç </a></li>
        <li><a href="#å›¾ç‰‡-2">å›¾ç‰‡</a></li>
      </ol>
    </li>
    <li><a href="#ç»†èƒåˆ†ç¾¤">ç»†èƒåˆ†ç¾¤</a>
      <ol>
        <li><a href="#è¯´æ˜-4">è¯´æ˜</a></li>
        <li><a href="#ä»£ç -4">ä»£ç </a></li>
        <li><a href="#å›¾ç‰‡-3">å›¾ç‰‡</a></li>
      </ol>
    </li>
    <li><a href="#å·®å¼‚åŸºå› æå–">å·®å¼‚åŸºå› æå–</a>
      <ol>
        <li><a href="#è¯´æ˜-5">è¯´æ˜</a></li>
        <li><a href="#ä»£ç -5">ä»£ç </a></li>
        <li><a href="#å›¾ç‰‡-4">å›¾ç‰‡</a></li>
      </ol>
    </li>
    <li><a href="#ç»†èƒæ³¨é‡Š">ç»†èƒæ³¨é‡Š</a>
      <ol>
        <li><a href="#è¯´æ˜-6">è¯´æ˜</a></li>
        <li><a href="#ä»£ç -6">ä»£ç </a></li>
        <li><a href="#å›¾ç‰‡-5">å›¾ç‰‡</a></li>
      </ol>
    </li>
    <li><a href="#æ³¨é‡Šåå·®å¼‚åŸºå› å¯è§†åŒ–">æ³¨é‡Šåå·®å¼‚åŸºå› å¯è§†åŒ–</a>
      <ol>
        <li><a href="#è¯´æ˜-7">è¯´æ˜</a></li>
        <li><a href="#ä»£ç -7">ä»£ç </a></li>
        <li><a href="#å›¾ç‰‡-6">å›¾ç‰‡</a></li>
      </ol>
    </li>
    <li><a href="#gokegggseaå¯Œé›†åˆ†æ">GOã€KEGGã€GSEAå¯Œé›†åˆ†æ</a>
      <ol>
        <li><a href="#è¯´æ˜-8">è¯´æ˜</a></li>
        <li><a href="#ä»£ç -8">ä»£ç </a></li>
      </ol>
    </li>
    <li><a href="#cell-chatåˆ†æ">Cell Chatåˆ†æ</a>
      <ol>
        <li><a href="#è¯´æ˜-9">è¯´æ˜</a></li>
        <li><a href="#ä»£ç -9">ä»£ç </a></li>
      </ol>
    </li>
    <li><a href="#åŸºäºmonocle3çš„æ‹Ÿæ—¶åºåˆ†æ">åŸºäºMonocle3çš„æ‹Ÿæ—¶åºåˆ†æ</a>
      <ol>
        <li><a href="#è¯´æ˜-10">è¯´æ˜</a></li>
        <li><a href="#ä»£ç -10">ä»£ç </a></li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/none/">
                <img src="/p/none/seurat_banner_hu16161462109621688713.jpg"
                        srcset="/p/none/seurat_banner_hu16161462109621688713.jpg 800w, /p/none/seurat_banner_hu9546260091690285002.jpg 1600w"
                        width="800" 
                        height="176" 
                        loading="lazy"
                        alt="Featured image of post åŸºäºSeuratåŒ…çš„å•ç»†èƒåˆ†ææ ‡å‡†æµç¨‹" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/seurat%E7%AC%94%E8%AE%B0/" style="background-color: #2a9d8f; color: #fff;">
                Seuratç¬”è®°
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/none/">åŸºäºSeuratåŒ…çš„å•ç»†èƒåˆ†ææ ‡å‡†æµç¨‹</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            R;Seurat Package
        </h3>
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">2024-12-13</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    é˜…è¯»æ—¶é•¿: 20 åˆ†é’Ÿ
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h2 id="æ•°æ®é›†çš„å‡†å¤‡">æ•°æ®é›†çš„å‡†å¤‡
</h2><h3 id="è¯´æ˜">è¯´æ˜
</h3><p>é¦–å…ˆåœ¨https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE224679ä¸‹è½½GSM7029397_103_23_barcodes.tsv.gzã€GSM7029397_103_23_features.tsv.gzã€GSM7029397_103_23_matrix.mtx.gzï¼›GSM7029398_103_26_barcodes.tsv.gzã€GSM7029398_103_26_features.tsv.gzã€GSM7029398_103_26_matrix.mtx.gzå…­ä¸ªæ–‡ä»¶ï¼Œå…¶ä¸­å‰ä¸‰ä¸ªæ–‡ä»¶ä¸ºæœ‰FAPå®¶æ—å²çš„è‚¿ç˜¤æ‚£è€…çš„å•ç»†èƒæµ‹åºæ–‡ä»¶ï¼Œåä¸‰ä¸ªæ–‡ä»¶ä¸ºæœ‰FAPå®¶æ—å²çš„éè‚¿ç˜¤æ‚£è€…çš„å•ç»†èƒæµ‹åºæ–‡ä»¶ã€‚æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹â€œscRNAâ€ï¼Œå¹¶ä¸”åœ¨é‡Œé¢å»ºç«‹åä¸ºâ€œtumorâ€å’Œâ€œnormalâ€çš„æ–‡ä»¶å¤¹ï¼Œå°†å‰ä¸‰ä¸ªæ–‡ä»¶æ”¾å…¥â€œtumorâ€æ–‡ä»¶å¤¹ï¼Œåä¸‰ä¸ªæ–‡ä»¶æ”¾å…¥â€œnormalâ€æ–‡ä»¶å¤¹ã€‚</p>
<h3 id="ä»£ç ">ä»£ç 
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-R" data-lang="R"><span class="line"><span class="cl"><span class="kr">if</span> <span class="p">(</span><span class="o">!</span><span class="nf">require</span><span class="p">(</span><span class="n">Seurat</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">  <span class="n">BiocManager</span><span class="o">::</span><span class="nf">install</span><span class="p">(</span><span class="s">&#34;Seurat&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">Seurat</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">ggsci</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">ggrepel</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">setwd</span><span class="p">(</span><span class="s">&#34;D:\\scRNA&#34;</span><span class="p">)</span><span class="c1">#å°†ä¸‹è½½å¥½çš„æ–‡ä»¶æ”¾äºæ­¤å¤„ï¼Œå‰ä¸‰ä¸ªæ–‡ä»¶æ”¾äºtumoræ–‡ä»¶å¤¹ï¼Œåä¸‰ä¸ªæ”¾äºnormalæ–‡ä»¶å¤¹</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="è¯»å–æ•°æ®å¹¶æ„å»ºseuratå¯¹è±¡">è¯»å–æ•°æ®å¹¶æ„å»ºSeuratå¯¹è±¡
</h2><h3 id="è¯´æ˜-1">è¯´æ˜
</h3><p>å°†â€œtumorâ€å’Œâ€œnormalâ€æ–‡ä»¶å¤¹ä¸­çš„â€œXXX_features.tsv.tzâ€ï¼Œâ€œXXX_barcodes.tsv.tzâ€ï¼Œâ€œXXX_matrix.mtx.tzâ€ä¸‰ä¸ªæ–‡ä»¶åˆ†åˆ«é‡å‘½åä¸ºï¼šâ€œfeatures.tsv.tzâ€ï¼Œâ€œbarcodes.tsv.tzâ€ï¼Œâ€œmatrix.mtx.tzâ€ã€‚è¿™æ ·æ‰èƒ½è¢«Read10Xå‡½æ•°è¯»å–ã€‚</p>
<h3 id="ä»£ç -1">ä»£ç 
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-R" data-lang="R"><span class="line"><span class="cl"><span class="c1">#ç”¨Read10Xå‡½æ•°è¯»å–è‚¿ç˜¤æ ·æœ¬çš„å•ç»†èƒæ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="n">scRNA_data_t</span> <span class="o">&lt;-</span> <span class="nf">Read10X</span><span class="p">(</span><span class="n">data.dir</span><span class="o">=</span><span class="s">&#34;.\\tumor&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#Read10Xå‡½æ•°è¦æ±‚æ–‡ä»¶å¤¹é‡Œæœ‰ä¸‰ä¸ªæ–‡ä»¶ï¼šbarcodes.tsv.tzã€features.tsv.tzã€matrix.mtx.tzï¼Œåå­—å¿…é¡»ä¸€è‡´</span>
</span></span><span class="line"><span class="cl"><span class="c1">#è¿™ä¸‰ä¸ªæ–‡ä»¶åˆ†åˆ«æ˜¯å•ç»†èƒçš„barcodeã€å•ç»†èƒçš„æ³¨é‡Šä¿¡æ¯ä»¥åŠè¡¨è¾¾çŸ©é˜µ</span>
</span></span><span class="line"><span class="cl"><span class="c1">#è¯»å–çš„è¡¨è¾¾çŸ©é˜µæ˜¯ç”¨ç¨€ç–çŸ©é˜µè¿›è¡Œå­˜å‚¨ä»¥èŠ‚çœç©ºé—´,è‹¥æƒ³è½¬ä¸ºæ™®é€šçŸ©é˜µå¯ä»¥ç”¨as(x,&#34;sparseMatrix&#34;)è¿›è¡Œè½¬æ¢</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#æŸ¥çœ‹log2xçš„åˆ†å¸ƒæƒ…å†µï¼Œxæ˜¯åŸºå› è¡¨è¾¾é‡ï¼Œè§fig.1A</span>
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s">&#34;hist1.pdf&#34;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">5</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="m">5</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="nf">hist</span><span class="p">(</span><span class="nf">log2</span><span class="p">(</span><span class="n">scRNA_data_t</span><span class="o">@</span><span class="n">x</span><span class="p">),</span><span class="n">breaks</span><span class="o">=</span><span class="m">100</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#å¾—åˆ°è¯¥æ ·æœ¬çš„åŸºå› ååˆ—è¡¨å’Œç»†èƒååˆ—è¡¨</span>
</span></span><span class="line"><span class="cl"><span class="n">t_gene</span> <span class="o">&lt;-</span> <span class="nf">dimnames</span><span class="p">(</span><span class="n">scRNA_data_t</span><span class="p">)</span><span class="n">[[1]]</span>
</span></span><span class="line"><span class="cl"><span class="n">t_cell</span> <span class="o">&lt;-</span> <span class="nf">dimnames</span><span class="p">(</span><span class="n">scRNA_data_t</span><span class="p">)</span><span class="n">[[2]]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#æ„å»ºmetadata,å³æ ·æœ¬çš„æ³¨é‡Šä¿¡æ¯</span>
</span></span><span class="line"><span class="cl"><span class="n">metadata_t</span> <span class="o">=</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">row.names</span> <span class="o">=</span> <span class="n">t_cell</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">mutate</span><span class="p">(</span><span class="n">sample</span> <span class="o">=</span> <span class="s">&#39;GSE224679&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">type</span> <span class="o">=</span> <span class="s">&#39;Tumor&#39;</span><span class="p">)</span> <span class="c1">#ç»™æ¯ä¸ªç»†èƒåŠ ä¸Šæ³¨é‡Šä¿¡æ¯ï¼šå±äºGSE224679å’ŒTumorç»„</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#æ„å»ºSeuratå¯¹è±¡</span>
</span></span><span class="line"><span class="cl"><span class="n">srt1</span> <span class="o">&lt;-</span> <span class="nf">CreateSeuratObject</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">counts</span> <span class="o">=</span> <span class="n">scRNA_data_t</span><span class="p">,</span> <span class="c1">#æ•°æ®æ¥æºæ˜¯ç”¨Read10Xå‡½æ•°è¯»å…¥çš„scRNA_data_t</span>
</span></span><span class="line"><span class="cl">  <span class="n">meta.data</span> <span class="o">=</span> <span class="n">metadata_t</span><span class="p">,</span> <span class="c1">#æŒ‡å®šç»†èƒæ³¨é‡Šä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">  <span class="n">min.cells</span> <span class="o">=</span> <span class="m">3</span><span class="p">,</span> <span class="c1">#æŒ‡å®šåŸºå› å¿…é¡»åœ¨3ä¸ªåŠä»¥ä¸Šç»†èƒä¸­æ£€æµ‹åˆ°</span>
</span></span><span class="line"><span class="cl">  <span class="n">min.features</span> <span class="o">=</span> <span class="m">200</span> <span class="c1">#æ¯ä¸ªç»†èƒè‡³å°‘è¡¨è¾¾200ä¸ªåŸºå› æ‰ä¼šè¢«ä¿ç•™</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#æŸ¥çœ‹åŸå§‹çš„countsçŸ©é˜µ</span>
</span></span><span class="line"><span class="cl"><span class="n">srt1</span><span class="o">@</span><span class="n">assays[[</span><span class="s">&#39;RNA&#39;</span><span class="n">]]</span><span class="o">@</span><span class="n">layers[[</span><span class="s">&#39;counts&#39;</span><span class="n">]]</span> <span class="c1">#V5ä¸­Seuratå¯¹è±¡ç»“æ„æœ‰æ”¹åŠ¨ï¼Œä¸ä»¥å‰çš„æ–¹æ³•ä¸ä¸€æ ·</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#æå–åŸºå› åç§°</span>
</span></span><span class="line"><span class="cl"><span class="n">features</span> <span class="o">=</span> <span class="n">srt1</span><span class="o">@</span><span class="n">assays[[</span><span class="s">&#39;RNA&#39;</span><span class="n">]]</span><span class="o">@</span><span class="n">features</span>
</span></span><span class="line"><span class="cl"><span class="n">features</span> <span class="o">&lt;-</span> <span class="nf">dimnames</span><span class="p">(</span><span class="n">features</span><span class="p">)</span><span class="n">[[1]]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#è¯»å–normalæ–‡ä»¶å¤¹çš„æ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="n">scRNA_data_n</span> <span class="o">&lt;-</span> <span class="nf">Read10X</span><span class="p">(</span><span class="n">data.dir</span><span class="o">=</span><span class="s">&#34;.\\normal&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s">&#34;hist2.pdf&#34;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">5</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="m">5</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="nf">hist</span><span class="p">(</span><span class="nf">log2</span><span class="p">(</span><span class="n">scRNA_data_n</span><span class="o">@</span><span class="n">x</span><span class="p">),</span><span class="n">breaks</span><span class="o">=</span><span class="m">100</span><span class="p">)</span> <span class="c1">#fig.1B</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">n_gene</span> <span class="o">&lt;-</span> <span class="nf">dimnames</span><span class="p">(</span><span class="n">scRNA_data_n</span><span class="p">)</span><span class="n">[[1]]</span>
</span></span><span class="line"><span class="cl"><span class="n">n_cell</span> <span class="o">&lt;-</span> <span class="nf">dimnames</span><span class="p">(</span><span class="n">scRNA_data_n</span><span class="p">)</span><span class="n">[[2]]</span>
</span></span><span class="line"><span class="cl"><span class="n">metadata_n</span> <span class="o">=</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">row.names</span> <span class="o">=</span> <span class="n">n_cell</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">mutate</span><span class="p">(</span><span class="n">sample</span> <span class="o">=</span> <span class="s">&#39;GSE224679&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">type</span> <span class="o">=</span> <span class="s">&#39;Normal&#39;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="n">srt2</span> <span class="o">&lt;-</span> <span class="nf">CreateSeuratObject</span><span class="p">(</span><span class="n">counts</span> <span class="o">=</span> <span class="n">scRNA_data_n</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                           <span class="n">meta.data</span> <span class="o">=</span> <span class="n">metadata_n</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                           <span class="n">min.cells</span> <span class="o">=</span> <span class="m">3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                           <span class="n">min.features</span> <span class="o">=</span> <span class="m">200</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#åˆå¹¶äºŒä¸ªSeuratå¯¹è±¡å¹¶ä¿å­˜</span>
</span></span><span class="line"><span class="cl"><span class="n">sc_merged</span> <span class="o">&lt;-</span> <span class="nf">merge</span><span class="p">(</span><span class="n">srt1</span><span class="p">,</span><span class="n">srt2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">pbmc</span> <span class="o">&lt;-</span> <span class="n">sc_merged</span>
</span></span><span class="line"><span class="cl"><span class="nf">save</span><span class="p">(</span><span class="n">pbmc</span><span class="p">,</span><span class="n">file</span><span class="o">=</span><span class="s">&#34;merged_raw_counts.rda&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#æŸ¥çœ‹pbmcä¸­countå’Œfeatureçš„åˆ†å¸ƒæƒ…å†µ</span>
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s">&#34;nCount_RNA.pdf&#34;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">5</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="m">5</span><span class="p">)</span> <span class="c1">#ç»Ÿè®¡æ¯ä¸ªç»†èƒä¸­æµ‹åˆ°çš„countæ€»å’Œçš„é¢‘æ•°åˆ†å¸ƒï¼Œfig1.C</span>
</span></span><span class="line"><span class="cl"><span class="nf">hist</span><span class="p">(</span><span class="n">pbmc</span><span class="o">$</span><span class="n">nCount_RNA</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s">&#34;nFeature_RNA.pdf&#34;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">5</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="m">5</span><span class="p">)</span> <span class="c1">#ç»Ÿè®¡æ¯ä¸ªç»†èƒä¸­æœ‰è¡¨è¾¾çš„åŸºå› çš„æ•°é‡çš„é¢‘æ•°åˆ†å¸ƒï¼Œfig.1.D </span>
</span></span><span class="line"><span class="cl"><span class="nf">hist</span><span class="p">(</span><span class="n">pbmc</span><span class="o">$</span><span class="n">nFeature_RNA</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="å›¾ç‰‡">å›¾ç‰‡
</h3><p><img src="/p/none/fig.1.jpg"
	width="2421"
	height="2367"
	srcset="/p/none/fig.1_hu4014957062723920639.jpg 480w, /p/none/fig.1_hu18075892461853253435.jpg 1024w"
	loading="lazy"
	
		alt="fig.1"
	
	
		class="gallery-image" 
		data-flex-grow="102"
		data-flex-basis="245px"
	
></p>
<h2 id="è´¨é‡æ§åˆ¶">è´¨é‡æ§åˆ¶
</h2><h3 id="è¯´æ˜-2">è¯´æ˜
</h3><h3 id="ä»£ç -2">ä»£ç 
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-R" data-lang="R"><span class="line"><span class="cl"><span class="c1">#æŸ¥çœ‹çº¿ç²’ä½“åŸºå› é¢‘æ•°åˆ†å¸ƒå›¾ï¼Œpatternå‚æ•°æ˜¯æŒ‡åŒ¹é…MTå¼€å¤´çš„åŸºå› ,fig.2.A</span>
</span></span><span class="line"><span class="cl"><span class="n">pbmc</span><span class="o">$</span><span class="n">Percent.Mito</span> <span class="o">&lt;-</span> <span class="nf">PercentageFeatureSet</span><span class="p">(</span><span class="n">pbmc</span><span class="p">,</span><span class="n">pattern</span> <span class="o">=</span> <span class="s">&#39;^MT-&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s">&#34;Percent.mito.pdf&#34;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">5</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="m">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">hist</span><span class="p">(</span><span class="n">pbmc</span><span class="o">$</span><span class="n">Percent.Mito</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#æŸ¥çœ‹å¤–æºåŸºå› é¢‘æ•°åˆ†å¸ƒå›¾,åŒ¹é…ä»¥ERCCå¼€å¤´çš„åŸºå› ï¼Œfig.2.B</span>
</span></span><span class="line"><span class="cl"><span class="n">pbmc</span><span class="o">$</span><span class="n">Percent.ERCC</span> <span class="o">&lt;-</span> <span class="nf">PercentageFeatureSet</span><span class="p">(</span><span class="n">pbmc</span><span class="p">,</span><span class="n">pattern</span> <span class="o">=</span> <span class="s">&#39;^ERCC&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s">&#34;Percent.ERCC.pdf&#34;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">5</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="m">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">hist</span><span class="p">(</span><span class="n">pbmc</span><span class="o">$</span><span class="n">Percent.ERCC</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#æŸ¥çœ‹æ ¸ç³–ä½“åŸºå› é¢‘æ•°åˆ†å¸ƒå›¾,åŒ¹é…ä»¥RPSæˆ–RPLå¼€å¤´çš„åŸºå› ï¼Œfig.2.C</span>
</span></span><span class="line"><span class="cl"><span class="n">pbmc</span><span class="o">$</span><span class="n">Percent.Ribo</span> <span class="o">&lt;-</span> <span class="nf">PercentageFeatureSet</span><span class="p">(</span><span class="n">pbmc</span><span class="p">,</span><span class="n">pattern</span> <span class="o">=</span> <span class="s">&#39;^RP[SL]&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s">&#34;Percent.Ribo.pdf&#34;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">5</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="m">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">hist</span><span class="p">(</span><span class="n">pbmc</span><span class="o">$</span><span class="n">Percent.Ribo</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">###å¯è§†åŒ–###</span>
</span></span><span class="line"><span class="cl"><span class="c1">#å°æç´å›¾ï¼Œå¯ä»¥æŒ‡å®šå¯¹å“ªä¸ªå˜é‡è¿›è¡Œç”»å›¾ï¼Œä»¥åŠæŒ‡å®šåˆ†ç»„ä¾æ®ã€‚å¯ä»¥æŒ‡å®šseuratå¯¹è±¡ä¸­çš„metadataä¸­çš„ç±»åˆ«è¿›è¡Œåˆ†ç»„,fig.2.Dã€fig.2.Eã€fig.2.Fã€fig.2.G</span>
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s">&#34;nFeature_RNA_VlnPlot.pdf&#34;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">5</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="m">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">VlnPlot</span><span class="p">(</span><span class="n">pbmc</span><span class="p">,</span><span class="n">features</span> <span class="o">=</span> <span class="s">&#39;nFeature_RNA&#39;</span><span class="p">,</span><span class="n">group.by</span> <span class="o">=</span> <span class="s">&#39;type&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">alpha</span> <span class="o">=</span> <span class="m">0.1</span><span class="p">,</span><span class="n">pt.size</span> <span class="o">=</span> <span class="m">0.01</span><span class="p">)</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_hline</span><span class="p">(</span><span class="n">yintercept</span> <span class="o">=</span> <span class="m">2000</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s">&#39;red&#39;</span><span class="p">)</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scale_fill_igv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s">&#34;nCount_RNA_VlnPlot.pdf&#34;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">5</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="m">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">VlnPlot</span><span class="p">(</span><span class="n">pbmc</span><span class="p">,</span><span class="n">features</span> <span class="o">=</span> <span class="s">&#39;nCount_RNA&#39;</span><span class="p">,</span><span class="n">group.by</span> <span class="o">=</span> <span class="s">&#39;type&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">alpha</span> <span class="o">=</span> <span class="m">0.1</span><span class="p">,</span><span class="n">pt.size</span> <span class="o">=</span> <span class="m">0.01</span><span class="p">)</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_hline</span><span class="p">(</span><span class="n">yintercept</span> <span class="o">=</span> <span class="m">5000</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s">&#39;red&#39;</span><span class="p">)</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scale_fill_igv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s">&#34;Percent.Ribo_VlnPlot.pdf&#34;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">5</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="m">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">VlnPlot</span><span class="p">(</span><span class="n">pbmc</span><span class="p">,</span><span class="n">features</span> <span class="o">=</span> <span class="s">&#39;Percent.Ribo&#39;</span><span class="p">,</span><span class="n">group.by</span> <span class="o">=</span> <span class="s">&#39;type&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">alpha</span> <span class="o">=</span> <span class="m">0.1</span><span class="p">,</span><span class="n">pt.size</span> <span class="o">=</span> <span class="m">0.01</span><span class="p">)</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_hline</span><span class="p">(</span><span class="n">yintercept</span> <span class="o">=</span> <span class="m">2000</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s">&#39;red&#39;</span><span class="p">)</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scale_fill_igv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s">&#34;Percent.Mito_VlnPlot.pdf&#34;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">5</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="m">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">VlnPlot</span><span class="p">(</span><span class="n">pbmc</span><span class="p">,</span><span class="n">features</span> <span class="o">=</span> <span class="s">&#39;Percent.Mito&#39;</span><span class="p">,</span><span class="n">group.by</span> <span class="o">=</span> <span class="s">&#39;type&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">alpha</span> <span class="o">=</span> <span class="m">0.1</span><span class="p">,</span><span class="n">pt.size</span> <span class="o">=</span> <span class="m">0.01</span><span class="p">)</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_hline</span><span class="p">(</span><span class="n">yintercept</span> <span class="o">=</span> <span class="m">2000</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s">&#39;red&#39;</span><span class="p">)</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scale_fill_igv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#æ•£ç‚¹å›¾ï¼Œç”¨æ¥çœ‹ä¸¤ä¸ªmetadataä¹‹é—´çš„å…³ç³»ï¼Œè¿™é‡Œp1çœ‹çš„æ˜¯nFeatureå’ŒnCountçš„å…³ç³»ï¼Œp2çœ‹çš„æ˜¯Percent.Riboå’ŒPercent.Mitoä¹‹é—´çš„å…³ç³»ï¼Œfig.2.H</span>
</span></span><span class="line"><span class="cl"><span class="n">p1</span> <span class="o">&lt;-</span> <span class="nf">FeatureScatter</span><span class="p">(</span><span class="n">object</span> <span class="o">=</span> <span class="n">pbmc</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                     <span class="n">group.by</span> <span class="o">=</span> <span class="s">&#39;type&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                     <span class="n">raster</span> <span class="o">=</span> <span class="bp">F</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                     <span class="n">shuffle</span> <span class="o">=</span> <span class="bp">T</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                     <span class="n">pt.size</span> <span class="o">=</span> <span class="m">0.05</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                     <span class="n">feature1</span> <span class="o">=</span> <span class="s">&#34;nFeature_RNA&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                     <span class="n">feature2</span> <span class="o">=</span> <span class="s">&#34;nCount_RNA&#34;</span><span class="p">)</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scale_color_igv</span><span class="p">()</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">guides</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="nf">guide_legend</span><span class="p">(</span><span class="n">override.aes</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="m">4</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">p2</span> <span class="o">&lt;-</span> <span class="nf">FeatureScatter</span><span class="p">(</span><span class="n">object</span> <span class="o">=</span> <span class="n">pbmc</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                     <span class="n">group.by</span> <span class="o">=</span> <span class="s">&#39;type&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                     <span class="n">raster</span> <span class="o">=</span> <span class="bp">F</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                     <span class="n">shuffle</span> <span class="o">=</span> <span class="bp">T</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                     <span class="n">pt.size</span> <span class="o">=</span> <span class="m">0.05</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                     <span class="n">feature1</span> <span class="o">=</span> <span class="s">&#34;Percent.Ribo&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                     <span class="n">feature2</span> <span class="o">=</span> <span class="s">&#34;Percent.Mito&#34;</span><span class="p">)</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scale_color_igv</span><span class="p">()</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">guides</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="nf">guide_legend</span><span class="p">(</span><span class="n">override.aes</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="m">4</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#å°†ä¸¤ä¸ªå›¾æ‹¼èµ·æ¥</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="n">p1</span> <span class="o">+</span> <span class="n">p2</span><span class="p">;</span><span class="n">p</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggsave</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">filename</span> <span class="o">=</span> <span class="s">&#34;quality.pdf&#34;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">10</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="m">4.5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#è¿›ä¸€æ­¥ç­›é€‰æ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="n">pbmc_scaled</span> <span class="o">&lt;-</span> <span class="nf">subset</span><span class="p">(</span><span class="n">pbmc</span><span class="p">,</span><span class="n">nCount_RNA</span><span class="o">&gt;</span><span class="m">1000</span><span class="p">)</span> <span class="c1">#ç­›é€‰nCount_RNA&gt;1000çš„ç»†èƒ</span>
</span></span><span class="line"><span class="cl"><span class="n">pbmc_scaled</span> <span class="o">=</span> <span class="nf">subset</span><span class="p">(</span><span class="n">pbmc_scaled</span><span class="p">,</span><span class="n">nFeature_RNA</span><span class="o">&gt;</span><span class="m">500</span><span class="p">)</span><span class="c1">#ç­›é€‰nFeature_RNA&gt;500çš„ç»†èƒ</span>
</span></span><span class="line"><span class="cl"><span class="n">pbmc_scaled</span> <span class="o">=</span> <span class="nf">subset</span><span class="p">(</span><span class="n">pbmc_scaled</span><span class="p">,</span><span class="n">Percent.Mito</span><span class="o">&lt;</span><span class="m">20</span><span class="p">)</span><span class="c1">#ç­›é€‰Percent.Mito&lt;20çš„ç»†èƒ</span>
</span></span><span class="line"><span class="cl"><span class="n">pbmc_scaled</span> <span class="o">=</span> <span class="nf">subset</span><span class="p">(</span><span class="n">pbmc_scaled</span><span class="p">,</span><span class="n">Percent.Ribo</span><span class="o">&lt;</span><span class="m">40</span><span class="p">)</span><span class="c1">#ç­›é€‰Percent.Ribo&lt;40çš„ç»†èƒ</span>
</span></span><span class="line"><span class="cl"><span class="nf">dim</span><span class="p">(</span><span class="n">pbmc_scaled</span><span class="p">)</span><span class="c1">#æŸ¥çœ‹æ•°æ®ç»´æ•°ï¼Œå³æŸ¥çœ‹ç­›é€‰åè¿˜æœ‰å¤šå°‘ä¸ªç»†èƒï¼Œå¤šå°‘ä¸ªåŸºå› </span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="å›¾ç‰‡-1">å›¾ç‰‡
</h3><p><img src="/p/none/fig.2.jpg"
	width="2480"
	height="4223"
	srcset="/p/none/fig.2_hu2514115765104820831.jpg 480w, /p/none/fig.2_hu5790104892428646907.jpg 1024w"
	loading="lazy"
	
		alt="fig.2"
	
	
		class="gallery-image" 
		data-flex-grow="58"
		data-flex-basis="140px"
	
></p>
<h2 id="æ•°æ®é™ç»´">æ•°æ®é™ç»´
</h2><h3 id="è¯´æ˜-3">è¯´æ˜
</h3><p>å¸¸è§çš„é™ç»´æ–¹æ³•æœ‰3ç§ï¼šä¸»æˆåˆ†åˆ†æï¼ˆPCAï¼‰ã€T-åˆ†å¸ƒé¢†åŸŸåµŒå…¥ç®—æ³•ï¼ˆt-SNEï¼‰å’ŒUMAPï¼ˆç»Ÿä¸€æµå½¢é€¼è¿‘ä¸æŠ•å½±ï¼‰ã€‚ä¸‰è€…æ•°å­¦åŸç†å¤§ç›¸å¾„åº­ï¼Œä½†æ˜¯ä½œç”¨éƒ½æ˜¯å°†æˆåƒä¸Šä¸‡ç»´çš„æ•°æ®é™ä½è‡³äºŒç»´ï¼ˆä»¥ä¾¿åœ¨äºŒç»´å¹³é¢ä¸Šè¿›è¡Œç»˜å›¾ï¼‰ï¼ŒåŒæ—¶å°½å¯èƒ½åœ°ä¿æŒé«˜ç»´ç©ºé—´å†…çš„åˆ†å¸ƒç‰¹å¾ã€‚ä¾‹å¦‚ï¼Œé«˜ç»´ç©ºé—´ä¸­è·ç¦»è¾ƒè¿œçš„ç‚¹ï¼Œåœ¨é™è‡³äºŒç»´åè·ç¦»ä»åº”å½“è¾ƒè¿œï¼Œåä¹‹äº¦ç„¶ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œå¯¹é«˜ç»´æ•°æ®é¦–å…ˆè¿›è¡ŒPCAé™è‡³30ç»´ï¼Œå†ä½¿ç”¨t-SNEå’ŒUMAPç®—æ³•ï¼Œå°†è¯¥30ç»´æ•°æ®é™è‡³äºŒç»´ï¼ˆç›´æ¥ç”¨åä¸¤è€…é™ç»´å¯èƒ½ä¼šèŠ±è´¹å¾ˆé•¿çš„æ—¶é—´ï¼‰ã€‚æ­¤å¤–ï¼Œæœ€ç»ˆç»“æœçš„å±•ç¤ºå’Œè¿›ä¸€æ­¥åˆ†ææ¨èUMAPã€‚</p>
<h3 id="ä»£ç -3">ä»£ç 
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-R" data-lang="R"><span class="line"><span class="cl"><span class="n">pbmc</span> <span class="o">&lt;-</span> <span class="n">pbmc_scaled</span>
</span></span><span class="line"><span class="cl"><span class="n">pbmc</span> <span class="o">&lt;-</span> <span class="nf">NormalizeData</span><span class="p">(</span><span class="n">object</span> <span class="o">=</span> <span class="n">pbmc</span><span class="p">)</span> <span class="c1">#è¿›è¡Œæ•°æ®æ ‡å‡†åŒ–ï¼Œæ¶ˆé™¤ä¸åŒç»†èƒä¹‹é—´çš„æµ‹åºæ·±åº¦å·®å¼‚</span>
</span></span><span class="line"><span class="cl"><span class="n">pbmc</span> <span class="o">&lt;-</span> <span class="nf">FindVariableFeatures</span><span class="p">(</span><span class="n">object</span> <span class="o">=</span> <span class="n">pbmc</span><span class="p">)</span> <span class="c1">#æå–é«˜å˜å¼‚åŸºå› </span>
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s">&#34;AVG-SV.pdf&#34;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">8</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="m">5</span><span class="p">)</span> <span class="c1">#æŸ¥çœ‹æ¯ä¸ªåŸºå› çš„å‡å€¼ä¸æ ‡å‡†å·®,fig.3.A</span>
</span></span><span class="line"><span class="cl"><span class="nf">VariableFeaturePlot</span><span class="p">(</span><span class="n">pbmc</span><span class="p">,</span><span class="n">cols</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&#39;grey&#39;</span><span class="p">,</span><span class="s">&#39;steelblue&#39;</span><span class="p">))</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scale_y_log10</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">pbmc</span> <span class="o">&lt;-</span> <span class="nf">ScaleData</span><span class="p">(</span><span class="n">object</span> <span class="o">=</span> <span class="n">pbmc</span><span class="p">)</span><span class="c1">#è¿›è¡Œæ•°æ®ç¼©æ”¾ï¼Œå°†åŸºå› è¡¨è¾¾é‡ç¼©æ”¾åˆ°å‡å€¼ä¸º0ï¼Œæ ‡å‡†å·®ä¸º1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#å¯è§†åŒ–ç¼©æ”¾åçš„data,fig.3.B</span>
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s">&#34;scaled_data.pdf&#34;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">6</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="m">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">hist</span><span class="p">(</span><span class="nf">colSums</span><span class="p">(</span><span class="n">pbmc</span><span class="p">,</span><span class="n">slot</span><span class="o">=</span><span class="s">&#39;scale.data&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">     <span class="n">breaks</span> <span class="o">=</span> <span class="m">50</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="n">main</span> <span class="o">=</span> <span class="s">&#39;Raw counts&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#PCA</span>
</span></span><span class="line"><span class="cl"><span class="n">pbmc</span> <span class="o">&lt;-</span> <span class="nf">RunPCA</span><span class="p">(</span><span class="n">object</span> <span class="o">=</span> <span class="n">pbmc</span><span class="p">)</span> <span class="c1">#è¿›è¡Œä¸»æˆåˆ†åˆ†æ</span>
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s">&#34;elbow.pdf&#34;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">6</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="m">5</span><span class="p">)</span><span class="c1">#å¯è§†åŒ–ä¸åŒä¸»æˆåˆ†çš„è´¡çŒ®ï¼Œfig.3C</span>
</span></span><span class="line"><span class="cl"><span class="nf">ElbowPlot</span><span class="p">(</span><span class="n">pbmc</span><span class="p">,</span><span class="n">ndims</span> <span class="o">=</span> <span class="m">30</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#tSNE and UMAPé™ç»´ï¼Œéœ€è¦åŸºäºPCAçš„ç»“æœï¼Œç”¨PCAçš„å‰30ä¸ªä¸»æˆåˆ†è¿›è¡Œé™ç»´ï¼Œæœ€ç»ˆé™è‡³äºŒç»´</span>
</span></span><span class="line"><span class="cl"><span class="n">pbmc</span> <span class="o">&lt;-</span> <span class="nf">RunTSNE</span><span class="p">(</span><span class="n">pbmc</span><span class="p">,</span><span class="n">dims</span> <span class="o">=</span> <span class="m">1</span><span class="o">:</span><span class="m">30</span><span class="p">,</span><span class="n">reduction</span> <span class="o">=</span> <span class="s">&#39;pca&#39;</span><span class="p">,</span><span class="n">reduction.name</span> <span class="o">=</span> <span class="s">&#39;tsne&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">pbmc</span> <span class="o">&lt;-</span> <span class="nf">RunUMAP</span><span class="p">(</span><span class="n">object</span> <span class="o">=</span> <span class="n">pbmc</span><span class="p">,</span> <span class="n">dims</span> <span class="o">=</span> <span class="m">1</span><span class="o">:</span><span class="m">30</span><span class="p">,</span> <span class="n">reduction</span> <span class="o">=</span> <span class="s">&#39;pca&#39;</span><span class="p">,</span><span class="n">reduction.name</span> <span class="o">=</span> <span class="s">&#39;umap&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">pbmc</span> <span class="o">&lt;-</span> <span class="nf">FindNeighbors</span><span class="p">(</span><span class="n">object</span> <span class="o">=</span> <span class="n">pbmc</span><span class="p">,</span> <span class="n">dims</span> <span class="o">=</span> <span class="m">1</span><span class="o">:</span><span class="m">30</span><span class="p">,</span> <span class="n">reduction</span> <span class="o">=</span> <span class="s">&#39;pca&#39;</span><span class="p">)</span><span class="c1">#æ ¹æ®å‰30ä¸ªä¸»æˆåˆ†æ„å»ºç»†èƒé—´é‚»æ¥å›¾</span>
</span></span><span class="line"><span class="cl"><span class="n">pbmc</span> <span class="o">&lt;-</span> <span class="nf">FindClusters</span><span class="p">(</span><span class="n">object</span> <span class="o">=</span> <span class="n">pbmc</span><span class="p">,</span><span class="n">resolution</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">cluster.name</span> <span class="o">=</span> <span class="s">&#39;unintegrated_clusters&#39;</span><span class="p">)</span><span class="c1">#è¿›è¡Œèšç±»ï¼ˆé¢„èšç±»ï¼‰</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s">&#34;pca.pdf&#34;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">6</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="m">5</span><span class="p">)</span> <span class="c1">#ç»˜åˆ¶PCAå›¾ï¼Œfig.3.D</span>
</span></span><span class="line"><span class="cl"><span class="nf">DimPlot</span><span class="p">(</span><span class="n">object</span> <span class="o">=</span> <span class="n">pbmc</span><span class="p">,</span> <span class="n">reduction</span> <span class="o">=</span> <span class="s">&#34;pca&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s">&#34;tsne.pdf&#34;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">6</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="m">5</span><span class="p">)</span> <span class="c1">#ç»˜åˆ¶t-SNEå›¾ï¼Œfig.3.E</span>
</span></span><span class="line"><span class="cl"><span class="nf">DimPlot</span><span class="p">(</span><span class="n">object</span> <span class="o">=</span> <span class="n">pbmc</span><span class="p">,</span> <span class="n">reduction</span> <span class="o">=</span> <span class="s">&#34;tsne&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s">&#34;umap.pdf&#34;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">6</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="m">5</span><span class="p">)</span> <span class="c1">#ç»˜åˆ¶UMAPå›¾ï¼Œfig.3.F</span>
</span></span><span class="line"><span class="cl"><span class="nf">DimPlot</span><span class="p">(</span><span class="n">object</span> <span class="o">=</span> <span class="n">pbmc</span><span class="p">,</span> <span class="n">reduction</span> <span class="o">=</span> <span class="s">&#34;umap&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#ä½¿ç”¨ä¸åŒçš„metadataè¿›è¡Œåˆ†ç±»ï¼Œå¹¶åˆ†åˆ«åœ¨umapå›¾ä¸Šè¿›è¡Œæ ‡æ³¨</span>
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s">&#34;multi_umap.pdf&#34;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">12</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="m">5</span><span class="p">)</span> <span class="c1">#fig.3.F</span>
</span></span><span class="line"><span class="cl"><span class="nf">DimPlot</span><span class="p">(</span><span class="n">object</span> <span class="o">=</span> <span class="n">pbmc</span><span class="p">,</span> <span class="n">reduction</span> <span class="o">=</span> <span class="s">&#39;umap&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">group.by</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#39;type&#39;</span><span class="p">,</span><span class="s">&#39;unintegrated_clusters&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="n">shuffle</span> <span class="o">=</span> <span class="bp">T</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="å›¾ç‰‡-2">å›¾ç‰‡
</h3><p><img src="/p/none/fig.3.jpg"
	width="2480"
	height="3937"
	srcset="/p/none/fig.3_hu3188378730347957910.jpg 480w, /p/none/fig.3_hu12424598183629885564.jpg 1024w"
	loading="lazy"
	
		alt="fig.3"
	
	
		class="gallery-image" 
		data-flex-grow="62"
		data-flex-basis="151px"
	
></p>
<h2 id="ç»†èƒåˆ†ç¾¤">ç»†èƒåˆ†ç¾¤
</h2><h3 id="è¯´æ˜-4">è¯´æ˜
</h3><p>æ ¹æ®ç»†èƒä¹‹é—´çš„äº²ç–å…³ç³»ï¼ˆå³ä»¥åŸºå› è¡¨è¾¾é‡ä¸ºåæ ‡ï¼Œé«˜ç»´ç©ºé—´å†…çš„è·ç¦»è¿œè¿‘ï¼‰è¿›è¡Œèšç±»ã€‚SeuratåŒ…ä¸­èšç±»æ–¹æ³•æ˜¯åŸºäºKä¸´è¿‘ç®—æ³•ï¼ˆKNNç®—æ³•ï¼‰å¼€å‘çš„ã€‚é€šè¿‡æ¯”è¾ƒä¸åŒåˆ†è¾¨ç‡ï¼ˆresolutionï¼‰ä¸‹çš„åˆ†ç±»æƒ…å†µï¼Œé€‰æ‹©åˆé€‚çš„åˆ†è¾¨ç‡ä½œä¸ºæœ€ç»ˆçš„åˆ†ç±»æ–¹æ³•ã€‚</p>
<h3 id="ä»£ç -4">ä»£ç 
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-R" data-lang="R"><span class="line"><span class="cl"><span class="c1">#è½½å…¥clustreeåŒ…</span>
</span></span><span class="line"><span class="cl"><span class="kr">if</span> <span class="p">(</span><span class="o">!</span><span class="nf">require</span><span class="p">(</span><span class="n">clustree</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">  <span class="n">BiocManager</span><span class="o">::</span><span class="nf">install</span><span class="p">(</span><span class="s">&#34;clustree&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">clustree</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pbmc_2</span> <span class="o">&lt;-</span> <span class="nf">JoinLayers</span><span class="p">(</span><span class="n">pbmc</span><span class="p">)</span><span class="c1">#å°†æ‰€æœ‰æ ·æœ¬åˆåœ¨ä¸€èµ·</span>
</span></span><span class="line"><span class="cl"><span class="n">pbmc_2</span> <span class="o">&lt;-</span> <span class="nf">FindNeighbors</span><span class="p">(</span><span class="n">object</span> <span class="o">=</span> <span class="n">pbmc_2</span><span class="p">,</span> <span class="n">dims</span> <span class="o">=</span> <span class="m">1</span><span class="o">:</span><span class="m">30</span><span class="p">,</span> <span class="n">reduction</span> <span class="o">=</span> <span class="s">&#39;pca&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">pbmc_2</span> <span class="o">&lt;-</span> <span class="nf">FindClusters</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">object</span> <span class="o">=</span> <span class="n">pbmc_2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">resolution</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="nf">seq</span><span class="p">(</span><span class="m">0.1</span><span class="p">,</span><span class="m">1.0</span><span class="p">,</span><span class="m">0.1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span><span class="c1">#åˆ†è¾¨ç‡0.1ã€0.2ã€0.3ã€...ã€1.0åˆ†åˆ«è¿›è¡Œèšç±»ï¼Œå…±èšç±»åæ¬¡ã€‚</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#ç”¨clustreeå‡½æ•°æ¥å¯è§†åŒ–ä¸åŒåˆ†è¾¨ç‡ä¸‹çš„åˆ†ç±»æƒ…å†µï¼Œfig.4.A</span>
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s">&#34;clustree.pdf&#34;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">6</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="m">8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">clustree</span><span class="p">(</span><span class="n">pbmc_2</span><span class="o">@</span><span class="n">meta.data</span><span class="p">,</span><span class="n">prefix</span> <span class="o">=</span> <span class="s">&#39;RNA_snn_res.&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#æŸ¥çœ‹ä¸åŒåˆ†ç¾¤æƒ…å†µä¸‹çš„umapå›¾ç»“æœï¼Œfig.4.B</span>
</span></span><span class="line"><span class="cl"><span class="n">p1</span> <span class="o">&lt;-</span> <span class="nf">DimPlot</span><span class="p">(</span><span class="n">pbmc_2</span><span class="p">,</span><span class="n">reduction</span><span class="o">=</span><span class="s">&#39;umap&#39;</span><span class="p">,</span><span class="n">group.by</span> <span class="o">=</span> <span class="s">&#34;RNA_snn_res.0.2&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="n">label</span> <span class="o">=</span> <span class="bp">T</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="n">repel</span> <span class="o">=</span> <span class="bp">F</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="n">shuffle</span> <span class="o">=</span> <span class="bp">T</span><span class="p">);</span><span class="n">p1</span>
</span></span><span class="line"><span class="cl"><span class="n">p2</span> <span class="o">&lt;-</span> <span class="nf">DimPlot</span><span class="p">(</span><span class="n">pbmc_2</span><span class="p">,</span><span class="n">reduction</span><span class="o">=</span><span class="s">&#39;umap&#39;</span><span class="p">,</span><span class="n">group.by</span> <span class="o">=</span> <span class="s">&#34;RNA_snn_res.0.3&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="n">label</span> <span class="o">=</span> <span class="bp">T</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="n">repel</span> <span class="o">=</span> <span class="bp">F</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="n">shuffle</span> <span class="o">=</span> <span class="bp">T</span><span class="p">);</span><span class="n">p2</span>
</span></span><span class="line"><span class="cl"><span class="n">p3</span> <span class="o">&lt;-</span> <span class="nf">DimPlot</span><span class="p">(</span><span class="n">pbmc_2</span><span class="p">,</span><span class="n">reduction</span><span class="o">=</span><span class="s">&#39;umap&#39;</span><span class="p">,</span><span class="n">group.by</span> <span class="o">=</span> <span class="s">&#34;RNA_snn_res.0.4&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="n">label</span> <span class="o">=</span> <span class="bp">T</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="n">repel</span> <span class="o">=</span> <span class="bp">F</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="n">shuffle</span> <span class="o">=</span> <span class="bp">T</span><span class="p">);</span><span class="n">p3</span>
</span></span><span class="line"><span class="cl"><span class="n">p4</span> <span class="o">&lt;-</span> <span class="nf">DimPlot</span><span class="p">(</span><span class="n">pbmc_2</span><span class="p">,</span><span class="n">reduction</span><span class="o">=</span><span class="s">&#39;umap&#39;</span><span class="p">,</span><span class="n">group.by</span> <span class="o">=</span> <span class="s">&#34;RNA_snn_res.0.5&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="n">label</span> <span class="o">=</span> <span class="bp">T</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="n">repel</span> <span class="o">=</span> <span class="bp">F</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="n">shuffle</span> <span class="o">=</span> <span class="bp">T</span><span class="p">);</span><span class="n">p4</span>
</span></span><span class="line"><span class="cl"><span class="n">p5</span> <span class="o">&lt;-</span> <span class="nf">DimPlot</span><span class="p">(</span><span class="n">pbmc_2</span><span class="p">,</span><span class="n">reduction</span><span class="o">=</span><span class="s">&#39;umap&#39;</span><span class="p">,</span><span class="n">group.by</span> <span class="o">=</span> <span class="s">&#34;RNA_snn_res.0.6&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="n">label</span> <span class="o">=</span> <span class="bp">T</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="n">repel</span> <span class="o">=</span> <span class="bp">F</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="n">shuffle</span> <span class="o">=</span> <span class="bp">T</span><span class="p">);</span><span class="n">p5</span>
</span></span><span class="line"><span class="cl"><span class="n">p6</span> <span class="o">&lt;-</span> <span class="nf">DimPlot</span><span class="p">(</span><span class="n">pbmc_2</span><span class="p">,</span><span class="n">reduction</span><span class="o">=</span><span class="s">&#39;umap&#39;</span><span class="p">,</span><span class="n">group.by</span> <span class="o">=</span> <span class="s">&#34;RNA_snn_res.1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="n">label</span> <span class="o">=</span> <span class="bp">T</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="n">repel</span> <span class="o">=</span> <span class="bp">F</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="n">shuffle</span> <span class="o">=</span> <span class="bp">T</span><span class="p">);</span><span class="n">p6</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="n">p1</span><span class="o">+</span><span class="n">p2</span><span class="o">+</span><span class="n">p3</span><span class="o">+</span><span class="n">p4</span><span class="o">+</span><span class="n">p5</span><span class="o">+</span><span class="n">p6</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggsave</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">filename</span> <span class="o">=</span> <span class="s">&#34;quality2.pdf&#34;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">13</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="m">8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#é€‰æ‹©åˆé€‚çš„åˆ†è¾¨ç‡ï¼Œè¿™é‡Œé€‰æ‹©0.5ï¼Œå…±åˆ†ä¸º15ç±»ï¼Œè¿™ä¾¿æ˜¯æœ€ç»ˆçš„åˆ†ç±»</span>
</span></span><span class="line"><span class="cl"><span class="n">pbmc_2</span><span class="o">$</span><span class="n">seurat_clusters</span> <span class="o">=</span> <span class="n">pbmc_2</span><span class="o">$</span><span class="n">RNA_snn_res.0.5</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#ç»˜åˆ¶resolution=0.5æ—¶çš„æœ€ç»ˆumapå›¾åƒï¼Œfig.4.C</span>
</span></span><span class="line"><span class="cl"><span class="n">p1</span> <span class="o">&lt;-</span> <span class="nf">UMAPPlot</span><span class="p">(</span><span class="n">pbmc_2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="n">label</span> <span class="o">=</span> <span class="bp">T</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="n">repel</span> <span class="o">=</span> <span class="bp">F</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="n">group.by</span> <span class="o">=</span> <span class="s">&#39;seurat_clusters&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&#39;UMAP&#39;</span><span class="p">)</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">theme_bw</span><span class="p">()</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">theme</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">plot.title</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">face</span> <span class="o">=</span> <span class="s">&#39;bold&#39;</span><span class="p">,</span><span class="n">hjust</span> <span class="o">=</span> <span class="m">0.5</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">plot.background</span> <span class="o">=</span> <span class="nf">element_rect</span><span class="p">(</span><span class="n">fill</span> <span class="o">=</span> <span class="s">&#39;transparent&#39;</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="kc">NA</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scale_color_igv</span><span class="p">();</span><span class="n">p1</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggsave</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="n">filename</span> <span class="o">=</span> <span class="s">&#34;final_umap.pdf&#34;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">13</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="m">8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">Idents</span><span class="p">(</span><span class="n">pbmc_2</span><span class="p">)</span> <span class="o">=</span> <span class="s">&#39;seurat_clusters&#39;</span> è®¾ç½®<span class="n">metadataä¸­é»˜è®¤ç´¢å¼•æ˜¯</span>â€˜<span class="n">seurat_clusters</span>â€™
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="å›¾ç‰‡-3">å›¾ç‰‡
</h3><p><img src="/p/none/fig.4.jpg"
	width="2480"
	height="6501"
	srcset="/p/none/fig.4_hu7732658598330838473.jpg 480w, /p/none/fig.4_hu13013129180716759453.jpg 1024w"
	loading="lazy"
	
		alt="fig.4"
	
	
		class="gallery-image" 
		data-flex-grow="38"
		data-flex-basis="91px"
	
></p>
<h2 id="å·®å¼‚åŸºå› æå–">å·®å¼‚åŸºå› æå–
</h2><h3 id="è¯´æ˜-5">è¯´æ˜
</h3><p>ä½¿ç”¨FindAllMarkerså‡½æ•°æå–æ¯ä¸€ç»„å†…çš„å·®å¼‚è¡¨è¾¾åŸºå› ï¼Œåˆ†ç»„ä¾æ®æ˜¯ä¸Šè¿°çš„resolution=0.5æ—¶çš„è‡ªåŠ¨åˆ†ç»„ï¼Œå³â€˜Seurat clustersâ€™ï¼Œä¹Ÿå°±æ˜¯Idents(pbmc_2)ã€‚æ¥ç€æå–æ¯ç»„ä¸­å·®å¼‚è¡¨è¾¾æœ€æ˜æ˜¾çš„3ä¸ªåŸºå› æå–å‡ºæ¥ï¼Œå°†å®ƒä»¬åœ¨æ¯ä¸€ç»„ç»†èƒå†…çš„è¡¨è¾¾æƒ…å†µç”¨çƒ­å›¾ã€æ°”æ³¡å›¾æˆ–å°æç´å›¾å±•ç¤ºå‡ºæ¥ã€‚æ³¨æ„ï¼è¿™ä¸‰ç§å›¾åŒ…å«ç€åŒæ ·çš„ä¿¡æ¯ï¼Œé€‰å–ä¸€ä¸ªå³å¯ã€‚</p>
<p>æ­¤å¤–ï¼ŒFeaturePlotå‡½æ•°å…è®¸æŒ‡å®šå¤šä¸ªåŸºå› ï¼Œå¹¶å¯è§†åŒ–è¿™äº›åŸºå› åœ¨ç»†èƒä¸­çš„è¡¨è¾¾æƒ…å†µï¼Œå¯ä»¥é€‰æ‹©æ„Ÿå…´è¶£çš„åŸºå› è¿›è¡Œç»˜å›¾ã€‚</p>
<h3 id="ä»£ç -5">ä»£ç 
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-R" data-lang="R"><span class="line"><span class="cl"><span class="n">sc.markers</span> <span class="o">&lt;-</span> <span class="nf">FindAllMarkers</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">object</span> <span class="o">=</span> <span class="n">pbmc_2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">only.pos</span> <span class="o">=</span> <span class="bp">F</span><span class="p">,</span> <span class="c1">#ä¿ç•™ä¸Šè°ƒä¸ä¸‹è°ƒçš„åŸºå› </span>
</span></span><span class="line"><span class="cl">  <span class="n">test.use</span> <span class="o">=</span> <span class="s">&#39;wilcox&#39;</span><span class="p">,</span> <span class="c1">#æ£€éªŒæ–¹æ³•æ˜¯wilcoxnæ£€éªŒ</span>
</span></span><span class="line"><span class="cl">  <span class="n">slot</span> <span class="o">=</span> <span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="c1">#é»˜è®¤ä½¿ç”¨dataè€Œä¸æ˜¯counts</span>
</span></span><span class="line"><span class="cl">  <span class="n">min.pct</span> <span class="o">=</span> <span class="m">0.25</span><span class="p">,</span> <span class="c1">#è¯¥åŸºå› åœ¨è‡³å°‘25%çš„ç»†èƒå†…è¡¨è¾¾</span>
</span></span><span class="line"><span class="cl">  <span class="n">logfc.threshold</span> <span class="o">=</span> <span class="m">0.25</span> <span class="c1">#è®¾ç½®log2FCçš„é˜ˆå€¼</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span> <span class="c1">#è¿™ä¸ªå‡½æ•°é‡Œæ²¡æœ‰æŒ‡å®šåˆ†ç»„ï¼Œåˆ™å®ƒä¼šä½¿ç”¨é»˜è®¤åˆ†ç»„ä¾æ®ï¼Œå³Idents(pbmc_2)</span>
</span></span><span class="line"><span class="cl"><span class="nf">save</span><span class="p">(</span><span class="n">sc.markers</span><span class="p">,</span><span class="n">file</span> <span class="o">=</span> <span class="s">&#39;ALL_MARKERS.rda&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#å–å‡ºæ¯ç¾¤è¡¨è¾¾ä¸­top3é«˜çš„åŸºå› </span>
</span></span><span class="line"><span class="cl"><span class="n">top3</span> <span class="o">&lt;-</span> <span class="n">sc.markers</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">filter</span><span class="p">(</span><span class="n">avg_log2FC</span> <span class="o">&gt;</span> <span class="m">0</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">group_by</span><span class="p">(</span><span class="n">cluster</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="c1">#ä»¥metadataä¸­çš„â€˜clusterâ€™æ¥è¿›è¡Œåˆ†ç±»</span>
</span></span><span class="line"><span class="cl">  <span class="nf">filter</span><span class="p">(</span><span class="n">p_val_adj</span> <span class="o">&lt;</span> <span class="m">0.05</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">top_n</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="n">avg_log2FC</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">group_by</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">###å·®å¼‚åŸºå› å¯è§†åŒ–###</span>
</span></span><span class="line"><span class="cl"><span class="c1">#å„ç»˜å›¾æ–¹å¼ä¿¡æ¯é‡ä¸€è‡´ï¼Œé€‰æ‹©ä¸€ç§å³å¯</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#çƒ­å›¾ï¼Œfig.5.A</span>
</span></span><span class="line"><span class="cl"><span class="nf">DoHeatmap</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">object</span> <span class="o">=</span> <span class="n">pbmc_2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">features</span> <span class="o">=</span> <span class="n">top3</span><span class="o">$</span><span class="n">gene</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">label</span> <span class="o">=</span> <span class="kc">TRUE</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scale_fill_gradient</span><span class="p">(</span><span class="n">low</span> <span class="o">=</span> <span class="s">&#39;lightgrey&#39;</span><span class="p">,</span><span class="n">high</span> <span class="o">=</span> <span class="s">&#39;salmon&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggsave</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="s">&#39;Heatmap.pdf&#39;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">10</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="m">8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#ç‚¹å›¾ï¼Œfig.5.B</span>
</span></span><span class="line"><span class="cl"><span class="nf">DotPlot</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">object</span> <span class="o">=</span> <span class="n">pbmc_2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">group.by</span> <span class="o">=</span> <span class="s">&#39;seurat_clusters&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">cols</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#39;lightgrey&#39;</span><span class="p">,</span><span class="s">&#39;salmon&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">  <span class="n">features</span> <span class="o">=</span> <span class="nf">unique</span><span class="p">(</span><span class="n">top3</span><span class="o">$</span><span class="n">gene</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">coord_flip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggsave</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="s">&#39;dotplot.pdf&#39;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">10</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="m">8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#å°æç´å›¾ï¼Œfig.5.C</span>
</span></span><span class="line"><span class="cl"><span class="nf">VlnPlot</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">object</span> <span class="o">=</span> <span class="n">pbmc_2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">group.by</span> <span class="o">=</span> <span class="s">&#39;seurat_clusters&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="c1">#fill.by = &#39;feature&#39;,</span>
</span></span><span class="line"><span class="cl">  <span class="n">stack</span> <span class="o">=</span> <span class="bp">T</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">flip</span> <span class="o">=</span> <span class="bp">T</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">features</span> <span class="o">=</span> <span class="nf">unique</span><span class="p">(</span><span class="n">top3</span><span class="o">$</span><span class="n">gene</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scale_fill_igv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggsave</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="s">&#39;vlnplot.pdf&#39;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">10</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="m">8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#å¯¹äºæ„Ÿå…´è¶£çš„åŸºå› è¿›è¡Œç»˜å›¾,fig.5.D</span>
</span></span><span class="line"><span class="cl"><span class="nf">FeaturePlot</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">pbmc_2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">features</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#39;CD8A&#39;</span><span class="p">,</span><span class="s">&#39;CD4&#39;</span><span class="p">,</span><span class="s">&#39;ZNF683&#39;</span><span class="p">,</span><span class="s">&#39;OLFM4&#39;</span><span class="p">),</span><span class="c1">#å¯ä»¥é€‰æ‹©æ„Ÿå…´è¶£çš„åŸºå› è¿›è¡Œç»˜å›¾</span>
</span></span><span class="line"><span class="cl">  <span class="n">order</span> <span class="o">=</span> <span class="bp">T</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">alpha</span> <span class="o">=</span> <span class="m">0.3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">reduction</span> <span class="o">=</span> <span class="s">&#39;umap&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggsave</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="s">&#39;Featureplot.pdf&#39;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">10</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="m">8</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="å›¾ç‰‡-4">å›¾ç‰‡
</h3><p><img src="/p/none/fig.5.jpg"
	width="2480"
	height="7926"
	srcset="/p/none/fig.5_hu9172749854864766603.jpg 480w, /p/none/fig.5_hu9378333193762797066.jpg 1024w"
	loading="lazy"
	
		alt="fig.5"
	
	
		class="gallery-image" 
		data-flex-grow="31"
		data-flex-basis="75px"
	
></p>
<h2 id="ç»†èƒæ³¨é‡Š">ç»†èƒæ³¨é‡Š
</h2><h3 id="è¯´æ˜-6">è¯´æ˜
</h3><p>ç»†èƒæ³¨é‡Šï¼Œå³æ ¹æ®ç»†èƒé«˜è¡¨è¾¾çš„åŸºå› çš„ç‰¹å¾æ¥ä¸ºå…¶æŒ‡å®šä¸€ç§ç»†èƒç±»å‹ã€‚æ‰€ç ”ç©¶çš„markeråŸºå› å¯ä»¥å‚è€ƒç›¸å…³æ–‡çŒ®ã€å‚è€ƒå‰äººçš„ç»éªŒã€æˆ–è€…ä»CellMarkerå®˜ç½‘å¯¼å‡ºç­‰ã€‚æœ¬ä¾‹ä¸­ï¼Œä¸å…ç–«ç»†èƒç›¸å…³çš„markeråŸºå› æ¥æºäºåˆ«äººæ€»ç»“å¥½çš„ç»éªŒï¼Œä¸è‚ é“ç»†èƒç›¸å…³çš„markeråŸºå› æ˜¯ä»CellMarkerå®˜ç½‘ä¸Šå¯¼å‡ºçš„ï¼š</p>
<p><a class="link" href="http://117.50.127.228/CellMarker/index.html"  target="_blank" rel="noopener"
    ><img src="/p/none/CellMarker2.jpeg"
	width="439"
	height="104"
	srcset="/p/none/CellMarker2_hu11027654027863320400.jpeg 480w, /p/none/CellMarker2_hu2050711780003253907.jpeg 1024w"
	loading="lazy"
	
		alt="Cell Marer 2.0"
	
	
		class="gallery-image" 
		data-flex-grow="422"
		data-flex-basis="1013px"
	
></a></p>
<p>åœ¨CellMarker2.0ç½‘ç«™ä¸Šæ£€ç´¢è‚ é“çš„åˆ†å­Markerï¼Œåœ¨æ£€ç´¢é¡µé¢ä¾æ¬¡é€‰æ‹©human&ndash;gastrointestinal tract&ndash;allï¼Œå¯¼å‡ºTable.csvï¼Œè¿™é‡Œé¢ä¾¿åŒ…å«äº†è‚ é“ç»†èƒçš„MarkeråŸºå› ã€‚</p>
<h3 id="ä»£ç -6">ä»£ç 
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-R" data-lang="R"><span class="line"><span class="cl"><span class="n">immune_markers</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#39;CD8A&#39;</span><span class="p">,</span><span class="s">&#39;CD88&#39;</span><span class="p">,</span><span class="s">&#39;CD3D&#39;</span><span class="p">,</span><span class="s">&#39;CD3E&#39;</span><span class="p">,</span> <span class="c1">#CD8+T</span>
</span></span><span class="line"><span class="cl">                  <span class="s">&#39;CD4&#39;</span><span class="p">,</span> <span class="c1">#CD4+T</span>
</span></span><span class="line"><span class="cl">                  <span class="s">&#39;ZNF683&#39;</span><span class="p">,</span> <span class="c1">#NKT</span>
</span></span><span class="line"><span class="cl">                  <span class="s">&#39;NKG7&#39;</span><span class="p">,</span><span class="s">&#39;FCER1G&#39;</span><span class="p">,</span><span class="s">&#39;FGFBP2&#39;</span><span class="p">,</span><span class="s">&#39;FCGR3A&#39;</span><span class="p">,</span><span class="s">&#39;GZMH&#39;</span><span class="p">,</span><span class="s">&#39;TYROBP&#39;</span><span class="p">,</span><span class="s">&#39;IGFBP7&#39;</span><span class="p">,</span><span class="s">&#39;CD160&#39;</span><span class="p">,</span><span class="s">&#39;GZMB&#39;</span><span class="p">,</span> <span class="c1">#NK</span>
</span></span><span class="line"><span class="cl">                  <span class="s">&#39;CD74&#39;</span><span class="p">,</span><span class="s">&#39;CD79A&#39;</span><span class="p">,</span><span class="s">&#39;CD79B&#39;</span><span class="p">,</span><span class="s">&#39;MS4A1&#39;</span><span class="p">,</span> <span class="c1">#B cells</span>
</span></span><span class="line"><span class="cl">                  <span class="s">&#39;JCHAIN&#39;</span><span class="p">,</span><span class="s">&#39;MZB1&#39;</span><span class="p">,</span><span class="s">&#39;IGHG1&#39;</span><span class="p">,</span> <span class="c1">#Plasma cells</span>
</span></span><span class="line"><span class="cl">                  <span class="s">&#39;LYZ&#39;</span><span class="p">,</span><span class="s">&#39;S100A8&#39;</span><span class="p">,</span><span class="s">&#39;S100A9&#39;</span><span class="p">,</span><span class="s">&#39;CD14&#39;</span><span class="p">,</span> <span class="c1">#monocyte</span>
</span></span><span class="line"><span class="cl">                  <span class="s">&#39;PPBP&#39;</span> <span class="c1">#platelet</span>
</span></span><span class="line"><span class="cl">                  <span class="p">)</span><span class="c1">#è¿™ä¸ªæ˜¯å‚ç…§ä»–äººæ•´ç†å¥½çš„å†…å®¹</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#å†ä»CellMarker2.0ç½‘ç«™ä¸Šæ£€ç´¢è‚ é“çš„åˆ†å­Markerï¼Œé€‰æ‹©human-gastrointestinal tract-allï¼Œå¯¼å‡ºTable.csv</span>
</span></span><span class="line"><span class="cl"><span class="n">marker</span> <span class="o">&lt;-</span> <span class="nf">read.csv</span><span class="p">(</span><span class="s">&#34;Table.csv&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">marker</span> <span class="o">&lt;-</span> <span class="n">marker</span><span class="o">$</span><span class="n">Cell.marker</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#ç»˜åˆ¶æ°”æ³¡å›¾ï¼Œfig.6.A</span>
</span></span><span class="line"><span class="cl"><span class="n">plotdt</span> <span class="o">=</span> <span class="n">sc.markers</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">filter</span><span class="p">(</span><span class="n">gene</span> <span class="o">%in%</span> <span class="nf">c</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">marker</span><span class="p">),</span><span class="nf">c</span><span class="p">(</span><span class="n">immune_markers</span><span class="p">)))</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">arrange</span><span class="p">(</span><span class="n">cluster</span><span class="p">,</span><span class="n">avg_log2FC</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">mutate</span><span class="p">(</span><span class="n">gene</span> <span class="o">=</span> <span class="nf">factor</span><span class="p">(</span><span class="n">gene</span><span class="p">,</span><span class="n">levels</span> <span class="o">=</span> <span class="nf">unique</span><span class="p">(</span><span class="n">gene</span><span class="p">),</span><span class="n">ordered</span> <span class="o">=</span> <span class="bp">T</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">plotdt</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">cluster</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">gene</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">size</span> <span class="o">=</span> <span class="n">avg_log2FC</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">color</span> <span class="o">=</span> <span class="n">pct.1</span><span class="p">))</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_point</span><span class="p">()</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_text</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">label</span> <span class="o">=</span> <span class="n">cluster</span><span class="p">),</span><span class="n">size</span> <span class="o">=</span> <span class="m">3</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s">&#39;black&#39;</span><span class="p">)</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">theme_bw</span><span class="p">()</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">theme</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">plot.title</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">face</span> <span class="o">=</span> <span class="s">&#39;bold&#39;</span><span class="p">,</span><span class="n">hjust</span> <span class="o">=</span> <span class="m">0.5</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">plot.background</span> <span class="o">=</span> <span class="nf">element_rect</span><span class="p">(</span><span class="n">fill</span> <span class="o">=</span> <span class="s">&#39;transparent&#39;</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="kc">NA</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scale_color_gradient2</span><span class="p">(</span><span class="n">low</span> <span class="o">=</span> <span class="s">&#39;olivedrab&#39;</span><span class="p">,</span><span class="n">high</span> <span class="o">=</span> <span class="s">&#39;salmon&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="n">mid</span> <span class="o">=</span> <span class="s">&#39;yellow&#39;</span><span class="p">,</span><span class="n">midpoint</span> <span class="o">=</span> <span class="m">0.5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggsave</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="s">&#39;Featureplot_intestine_marker.pdf&#39;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">10</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="m">8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#å¯¹ç‰¹å®šçš„åŸºå› ï¼ˆè¿™é‡Œå¯ä»¥æ˜¯æŸ¥æ‰¾å‡ºæ¥çš„æŸäº›å·®å¼‚åŸºå› ï¼‰è¿›è¡Œfeature plotï¼Œfig.6.B</span>
</span></span><span class="line"><span class="cl"><span class="nf">FeaturePlot</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">pbmc_2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">features</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#39;KLRD1&#39;</span><span class="p">,</span><span class="s">&#39;TPSAB1&#39;</span><span class="p">,</span><span class="s">&#39;KIT&#39;</span><span class="p">,</span><span class="s">&#39;CD4&#39;</span><span class="p">,</span><span class="s">&#39;JCHAIN&#39;</span><span class="p">,</span><span class="s">&#39;MUC2&#39;</span><span class="p">,</span><span class="s">&#39;SELL&#39;</span><span class="p">,</span><span class="s">&#39;MS4A1&#39;</span><span class="p">,</span><span class="s">&#39;GUCA2B&#39;</span><span class="p">,</span><span class="s">&#39;CD3G&#39;</span><span class="p">,</span><span class="s">&#39;OLFM4&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">  <span class="n">order</span> <span class="o">=</span> <span class="bp">T</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">alpha</span> <span class="o">=</span> <span class="m">0.3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">reduction</span> <span class="o">=</span> <span class="s">&#39;umap&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggsave</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="s">&#39;all_feature.pdf&#39;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">10</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="m">8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#æ‰‹å·¥ç»†èƒæ³¨é‡Šï¼Œæ ¹æ®cell markerï¼Œç”¨è‚‰çœ¼å¤§è‡´çœ‹ä¸€ä¸‹æ˜¯å“ªç§ç»†èƒçš„markerï¼Œç„¶åæ‰‹å·¥ç»™æ¯ç¾¤ç»†èƒæ‰“ä¸Šæ ‡è®°ã€‚ä¸è¿‡è¿™ç§æ–¹å¼å¹¶ä¸ä¸€å®šå‡†ç¡®</span>
</span></span><span class="line"><span class="cl"><span class="n">pbmc_2</span><span class="o">$</span><span class="n">cell_type</span> <span class="o">=</span> <span class="nf">case_when</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">pbmc_2</span><span class="o">$</span><span class="n">seurat_clusters</span> <span class="o">%in%</span> <span class="nf">c</span><span class="p">(</span><span class="m">14</span><span class="p">)</span> <span class="o">~</span> <span class="s">&#39;Mast cells&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">pbmc_2</span><span class="o">$</span><span class="n">seurat_clusters</span> <span class="o">%in%</span> <span class="nf">c</span><span class="p">(</span><span class="m">13</span><span class="p">)</span> <span class="o">~</span> <span class="s">&#39;Unknown&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">pbmc_2</span><span class="o">$</span><span class="n">seurat_clusters</span> <span class="o">%in%</span> <span class="nf">c</span><span class="p">(</span><span class="m">12</span><span class="p">)</span> <span class="o">~</span> <span class="s">&#39;CD4+T cells&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">pbmc_2</span><span class="o">$</span><span class="n">seurat_clusters</span> <span class="o">%in%</span> <span class="nf">c</span><span class="p">(</span><span class="m">11</span><span class="p">)</span> <span class="o">~</span> <span class="s">&#39;Plasma cells&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">pbmc_2</span><span class="o">$</span><span class="n">seurat_clusters</span> <span class="o">%in%</span> <span class="nf">c</span><span class="p">(</span><span class="m">10</span><span class="p">)</span> <span class="o">~</span> <span class="s">&#39;Intestinal epithelial cells&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">pbmc_2</span><span class="o">$</span><span class="n">seurat_clusters</span> <span class="o">%in%</span> <span class="nf">c</span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="m">7</span><span class="p">)</span> <span class="o">~</span> <span class="s">&#39;B cells&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">pbmc_2</span><span class="o">$</span><span class="n">seurat_clusters</span> <span class="o">%in%</span> <span class="nf">c</span><span class="p">(</span><span class="m">8</span><span class="p">)</span> <span class="o">~</span> <span class="s">&#39;Unknown&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">pbmc_2</span><span class="o">$</span><span class="n">seurat_clusters</span> <span class="o">%in%</span> <span class="nf">c</span><span class="p">(</span><span class="m">9</span><span class="p">)</span> <span class="o">~</span> <span class="s">&#39;Unknown&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">pbmc_2</span><span class="o">$</span><span class="n">seurat_clusters</span> <span class="o">%in%</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">4</span><span class="p">)</span> <span class="o">~</span> <span class="s">&#39;Tumor cells&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">pbmc_2</span><span class="o">$</span><span class="n">seurat_clusters</span> <span class="o">%in%</span> <span class="nf">c</span><span class="p">(</span><span class="m">6</span><span class="p">)</span> <span class="o">~</span> <span class="s">&#39;T cells&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">pbmc_2</span><span class="o">$</span><span class="n">seurat_clusters</span> <span class="o">%in%</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">)</span> <span class="o">~</span> <span class="s">&#39;NK cells&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="kc">TRUE</span> <span class="o">~</span> <span class="s">&#39;Unknown&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">p1</span> <span class="o">&lt;-</span> <span class="nf">DimPlot</span><span class="p">(</span><span class="n">pbmc_2</span><span class="p">,</span><span class="n">reduction</span><span class="o">=</span><span class="s">&#39;umap&#39;</span><span class="p">,</span><span class="n">group.by</span> <span class="o">=</span> <span class="s">&#34;seurat_clusters&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="n">label</span> <span class="o">=</span> <span class="bp">T</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="n">repel</span> <span class="o">=</span> <span class="bp">F</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="n">shuffle</span> <span class="o">=</span> <span class="bp">T</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">p2</span> <span class="o">&lt;-</span> <span class="nf">DimPlot</span><span class="p">(</span><span class="n">pbmc_2</span><span class="p">,</span><span class="n">reduction</span><span class="o">=</span><span class="s">&#39;umap&#39;</span><span class="p">,</span><span class="n">group.by</span> <span class="o">=</span> <span class="s">&#34;cell_type&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="n">label</span> <span class="o">=</span> <span class="bp">T</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="n">repel</span> <span class="o">=</span> <span class="bp">F</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="n">shuffle</span> <span class="o">=</span> <span class="bp">T</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">p3</span> <span class="o">&lt;-</span> <span class="nf">DimPlot</span><span class="p">(</span><span class="n">pbmc_2</span><span class="p">,</span><span class="n">reduction</span><span class="o">=</span><span class="s">&#39;umap&#39;</span><span class="p">,</span><span class="n">group.by</span> <span class="o">=</span> <span class="s">&#34;type&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="n">label</span> <span class="o">=</span> <span class="bp">T</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="n">repel</span> <span class="o">=</span> <span class="bp">F</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="n">shuffle</span> <span class="o">=</span> <span class="bp">T</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="n">p1</span><span class="o">+</span><span class="n">p2</span><span class="o">+</span><span class="n">p3</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggsave</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">filename</span> <span class="o">=</span> <span class="s">&#34;contrast_umap.pdf&#34;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">24</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="m">8</span><span class="p">)</span><span class="c1">#fig.6.C</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">###å¯¹pbmc_2çš„meta.dataå¯è§†åŒ–###</span>
</span></span><span class="line"><span class="cl"><span class="c1">#è§‚å¯Ÿä¸åŒçš„ç»†èƒç±»å‹åœ¨è‚¿ç˜¤ç—…äººå’Œæ­£å¸¸ç—…äººä¹‹é—´çš„ä¸°åº¦æ¯”è¾ƒï¼Œfig.6.D</span>
</span></span><span class="line"><span class="cl"><span class="n">plotdata</span> <span class="o">=</span> <span class="n">pbmc_2</span><span class="o">@</span><span class="n">meta.data</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">&lt;-</span> <span class="nf">ggplot</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">plotdata</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">cell_type</span><span class="p">,</span><span class="n">fill</span> <span class="o">=</span> <span class="n">type</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_bar</span><span class="p">(</span><span class="n">position</span> <span class="o">=</span> <span class="s">&#39;dodge&#39;</span><span class="p">)</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scale_fill_igv</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="m">0.7</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggsave</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">filename</span> <span class="o">=</span> <span class="s">&#34;barplot.pdf&#34;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">10</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="m">6</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#è§‚å¯Ÿä¸¤ç±»ç—…äººçš„ä¸åŒç»†èƒçš„æ„æˆæ¯”ï¼Œfig.6.E</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">&lt;-</span> <span class="nf">ggplot</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">plotdata</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">type</span><span class="p">,</span><span class="n">fill</span> <span class="o">=</span> <span class="n">cell_type</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_bar</span><span class="p">(</span><span class="n">position</span> <span class="o">=</span> <span class="s">&#39;fill&#39;</span><span class="p">)</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scale_fill_igv</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="m">0.7</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggsave</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">filename</span> <span class="o">=</span> <span class="s">&#34;comparasion_barplot.pdf&#34;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">4</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="m">8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#å¯¹ä¸¤ä¸ªæ ·æœ¬åˆ†åˆ«ç»˜åˆ¶umapï¼Œfig.6.F</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">&lt;-</span> <span class="nf">UMAPPlot</span><span class="p">(</span><span class="n">pbmc_2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="n">label</span> <span class="o">=</span> <span class="bp">T</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="n">repel</span> <span class="o">=</span> <span class="bp">F</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="n">split.by</span> <span class="o">=</span> <span class="s">&#39;type&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="n">group.by</span> <span class="o">=</span> <span class="s">&#39;cell_type&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&#39;UMAP&#39;</span><span class="p">)</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">theme_bw</span><span class="p">()</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">theme</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">plot.title</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">face</span> <span class="o">=</span> <span class="s">&#39;bold&#39;</span><span class="p">,</span><span class="n">hjust</span> <span class="o">=</span> <span class="m">0.5</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">plot.background</span> <span class="o">=</span> <span class="nf">element_rect</span><span class="p">(</span><span class="n">fill</span> <span class="o">=</span> <span class="s">&#39;transparent&#39;</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="kc">NA</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scale_color_igv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggsave</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">filename</span> <span class="o">=</span> <span class="s">&#34;splited_umap.pdf&#34;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">15</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="m">8</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="å›¾ç‰‡-5">å›¾ç‰‡
</h3><p><img src="/p/none/fig.6.jpg"
	width="2480"
	height="7532"
	srcset="/p/none/fig.6_hu9158574167082283706.jpg 480w, /p/none/fig.6_hu16521760481829754738.jpg 1024w"
	loading="lazy"
	
		alt="fig..6"
	
	
		class="gallery-image" 
		data-flex-grow="32"
		data-flex-basis="79px"
	
></p>
<h2 id="æ³¨é‡Šåå·®å¼‚åŸºå› å¯è§†åŒ–">æ³¨é‡Šåå·®å¼‚åŸºå› å¯è§†åŒ–
</h2><h3 id="è¯´æ˜-7">è¯´æ˜
</h3><p>ä¸ä¸Šè¿°å¯»æ‰¾å·®å¼‚åŸºå› çš„è¿‡ç¨‹ç±»ä¼¼ï¼Œä¸è¿‡è¿™æ¬¡å·²ç»æ³¨é‡Šå¥½äº†ç»†èƒç±»å‹ï¼Œå¯ä»¥å†æ¬¡ç»˜åˆ¶å·®å¼‚è¡¨è¾¾åŸºå› çš„ç«å±±å›¾ã€çƒ­å›¾ç­‰ï¼Œæˆ–è€…æå–æŸä¸€ç§ç‰¹å®šçš„ç»†èƒï¼Œç ”ç©¶å…¶åœ¨ä¸åŒç»„é—´çš„è¡¨è¾¾å·®å¼‚ã€‚</p>
<h3 id="ä»£ç -7">ä»£ç 
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-R" data-lang="R"><span class="line"><span class="cl"><span class="c1">#ä¹‹å‰å¯»æ‰¾å·®å¼‚åŸºå› çš„æ—¶å€™ç”¨çš„æ˜¯è‡ªåŠ¨ç”Ÿæˆçš„unintegrated_clusterä½œä¸ºåˆ†ç±»ä¾æ®ï¼Œç°åœ¨ç”¨æ³¨é‡Šå¥½çš„cell_typeä½œä¸ºåˆ†ç±»ä¾æ®</span>
</span></span><span class="line"><span class="cl"><span class="nf">Idents</span><span class="p">(</span><span class="n">pbmc_2</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="s">&#34;cell_type&#34;</span> <span class="c1">#å°†cell_typeè®¾ç½®ä¸ºä¸»è¦çš„åˆ†ç±»æ ‡ç­¾</span>
</span></span><span class="line"><span class="cl"><span class="c1">#FindAllMarkerså‡½æ•°ä¼šåˆ†ææ¯ä¸ªIdentsä¸­çš„å·®å¼‚è¡¨è¾¾åŸºå› </span>
</span></span><span class="line"><span class="cl"><span class="n">cell.markers</span> <span class="o">&lt;-</span> <span class="nf">FindAllMarkers</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">object</span> <span class="o">=</span> <span class="n">pbmc_2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">only.pos</span> <span class="o">=</span> <span class="bp">F</span><span class="p">,</span> <span class="c1">#ä¿ç•™ä¸Šè°ƒä¸ä¸‹è°ƒçš„åŸºå› </span>
</span></span><span class="line"><span class="cl">  <span class="n">test.use</span> <span class="o">=</span> <span class="s">&#39;wilcox&#39;</span><span class="p">,</span> <span class="c1">#æ£€éªŒæ–¹æ³•æ˜¯wilcoxæ£€éªŒ</span>
</span></span><span class="line"><span class="cl">  <span class="n">slot</span> <span class="o">=</span> <span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="c1">#é»˜è®¤ä½¿ç”¨dataè€Œä¸æ˜¯counts</span>
</span></span><span class="line"><span class="cl">  <span class="n">min.pct</span> <span class="o">=</span> <span class="m">0.25</span><span class="p">,</span> <span class="c1">#åœ¨è‡³å°‘25%çš„ç»†èƒå†…è¡¨è¾¾</span>
</span></span><span class="line"><span class="cl">  <span class="n">logfc.threshold</span> <span class="o">=</span> <span class="m">0.25</span> <span class="c1">#è®¾ç½®log2FCçš„é˜ˆå€¼</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#FindMarkerså‡½æ•°é€šè¿‡æŒ‡å®šåˆ†ç»„ä¾æ®ï¼ˆgroup.byï¼‰ï¼Œä»¥åŠä¸¤ä¸ªidentï¼Œæ¥å¯»æ‰¾è¿™ä¸¤ä¸ªidentä¹‹é—´çš„å·®å¼‚åŸºå› </span>
</span></span><span class="line"><span class="cl"><span class="n">degs</span> <span class="o">=</span> <span class="nf">FindMarkers</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">pbmc_2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">logfc.threshold</span> <span class="o">=</span> <span class="m">0.5</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">only.pos</span> <span class="o">=</span> <span class="bp">F</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">ident.1</span> <span class="o">=</span> <span class="s">&#39;Tumor cells&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">ident.2</span> <span class="o">=</span> <span class="s">&#39;Intestinal epithelial cells&#39;</span><span class="p">,</span><span class="c1">#é»˜è®¤ä½¿ç”¨ident1 vs ident2ï¼Œè€Œä¸æ˜¯ç›¸å</span>
</span></span><span class="line"><span class="cl">  <span class="n">group.by</span> <span class="o">=</span> <span class="s">&#39;cell_type&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">mutate</span><span class="p">(</span><span class="n">gene</span><span class="o">=</span><span class="nf">rownames</span><span class="p">(</span><span class="n">.)</span><span class="p">)</span><span class="c1">#å°†åŸºå› åç­‰äºè¡Œåæ–¹ä¾¿åç»­æ“ä½œ</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#å¦‚æœæƒ³è¦è§‚å¯Ÿç‰¹å®šç»†èƒç±»å‹çš„å·®å¼‚åŸºå› ï¼Œå¯ä»¥å…ˆæå–å­é›†ï¼Œç„¶ååšç±»ä¼¼æ“ä½œã€‚æ¯”å¦‚è¿™é‡Œé€‰æ‹©åˆ†æTç»†èƒ</span>
</span></span><span class="line"><span class="cl"><span class="n">Tcell_subtype</span> <span class="o">=</span> <span class="nf">subset</span><span class="p">(</span><span class="n">pbmc_2</span> <span class="p">,</span> <span class="n">cell_type</span> <span class="o">==</span> <span class="s">&#39;T cells&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">Tcell_degs</span> <span class="o">=</span> <span class="nf">FindMarkers</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">Tcell_subtype</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">logfc.threshold</span> <span class="o">=</span> <span class="m">0.5</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">only.pos</span> <span class="o">=</span> <span class="bp">F</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">ident.1</span> <span class="o">=</span> <span class="s">&#39;Tumor&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">ident.2</span> <span class="o">=</span> <span class="s">&#39;Normal&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">group.by</span> <span class="o">=</span> <span class="s">&#39;type&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">mutate</span><span class="p">(</span><span class="n">gene</span><span class="o">=</span><span class="nf">rownames</span><span class="p">(</span><span class="n">.)</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">###å¯è§†åŒ–###</span>
</span></span><span class="line"><span class="cl"><span class="c1">#ç«å±±å›¾</span>
</span></span><span class="line"><span class="cl"><span class="c1">#å¯¹degså¯è§†åŒ–ï¼Œfig.7.A</span>
</span></span><span class="line"><span class="cl"><span class="n">change</span> <span class="o">=</span> <span class="nf">as.factor</span><span class="p">(</span><span class="nf">ifelse</span><span class="p">(</span><span class="n">degs</span><span class="o">$</span><span class="n">p_val_adj</span> <span class="o">&lt;</span> <span class="m">0.05</span> <span class="o">&amp;</span> <span class="nf">abs</span><span class="p">(</span><span class="n">degs</span><span class="o">$</span><span class="n">avg_log2FC</span><span class="p">)</span> <span class="o">&gt;</span> <span class="m">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                          <span class="nf">ifelse</span><span class="p">(</span><span class="n">degs</span><span class="o">$</span><span class="n">avg_log2FC</span> <span class="o">&gt;</span> <span class="m">1</span> <span class="p">,</span><span class="s">&#39;Up&#39;</span><span class="p">,</span><span class="s">&#39;Down&#39;</span><span class="p">),</span><span class="s">&#39;No change&#39;</span><span class="p">))</span><span class="c1">#æ ‡è®°ä¸Šè°ƒä¸‹è°ƒåŸºå› </span>
</span></span><span class="line"><span class="cl"><span class="n">filtered_degs</span> <span class="o">=</span> <span class="n">degs</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">filter</span><span class="p">(</span><span class="n">p_val_adj</span><span class="o">&lt;</span><span class="m">1e-100</span><span class="p">)</span><span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">filter</span><span class="p">(</span><span class="nf">abs</span><span class="p">(</span><span class="n">avg_log2FC</span><span class="p">)</span><span class="o">&gt;</span><span class="m">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">degs</span><span class="o">$</span><span class="n">label</span> <span class="o">&lt;-</span> <span class="nf">ifelse</span><span class="p">(</span><span class="n">degs</span><span class="o">$</span><span class="n">gene</span> <span class="o">%in%</span> <span class="n">filtered_degs</span><span class="o">$</span><span class="n">gene</span><span class="p">,</span> <span class="n">degs</span><span class="o">$</span><span class="n">gene</span><span class="p">,</span> <span class="kc">NA</span><span class="p">)</span><span class="c1">#æ ‡è®°ç›¸å½“æ˜¾è‘—çš„åŸºå› </span>
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="s">&#34;Tumor_vs_Unknown_vol.pdf&#34;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="m">5</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="m">5</span><span class="p">)</span><span class="c1">#ç»˜åˆ¶Tumor cellså’ŒUnknownç»„ä¹‹é—´çš„å·®å¼‚åŸºå› </span>
</span></span><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">degs</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">avg_log2FC</span><span class="p">,</span> <span class="o">-</span><span class="nf">log10</span><span class="p">(</span><span class="n">p_val_adj</span><span class="p">)))</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_hline</span><span class="p">(</span><span class="n">yintercept</span> <span class="o">=</span> <span class="o">-</span><span class="nf">log10</span><span class="p">(</span><span class="m">0.05</span><span class="p">),</span> <span class="n">linetype</span> <span class="o">=</span> <span class="s">&#34;dashed&#34;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&#34;#999999&#34;</span><span class="p">)</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">),</span> <span class="n">linetype</span> <span class="o">=</span> <span class="s">&#34;dashed&#34;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&#34;#999999&#34;</span><span class="p">)</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_point</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="n">change</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">             <span class="n">size</span> <span class="o">=</span> <span class="m">0.2</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">             <span class="n">alpha</span> <span class="o">=</span> <span class="m">0.5</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">theme_bw</span><span class="p">(</span><span class="n">base_size</span> <span class="o">=</span> <span class="m">12</span><span class="p">)</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_text_repel</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span><span class="p">),</span> 
</span></span><span class="line"><span class="cl">                  <span class="n">size</span> <span class="o">=</span> <span class="m">3</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                  <span class="n">box.padding</span> <span class="o">=</span> <span class="m">0.2</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                  <span class="n">max.overlaps</span> <span class="o">=</span> <span class="m">10</span><span class="p">)</span> <span class="o">+</span> <span class="c1"># é˜²æ­¢é‡å </span>
</span></span><span class="line"><span class="cl">  <span class="nf">scale_color_manual</span><span class="p">(</span><span class="n">values</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;Up&#34;</span> <span class="o">=</span> <span class="s">&#34;red&#34;</span><span class="p">,</span> <span class="s">&#34;Down&#34;</span> <span class="o">=</span> <span class="s">&#34;blue&#34;</span><span class="p">,</span> <span class="s">&#34;No change&#34;</span> <span class="o">=</span> <span class="s">&#34;gray&#34;</span><span class="p">))</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">theme</span><span class="p">(</span><span class="n">panel.grid</span> <span class="o">=</span> <span class="nf">element_blank</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">        <span class="n">legend.position</span> <span class="o">=</span> <span class="s">&#39;right&#39;</span><span class="p">)</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scale_x_continuous</span><span class="p">(</span><span class="n">limits</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="o">-</span><span class="nf">max</span><span class="p">(</span><span class="nf">abs</span><span class="p">(</span><span class="n">degs</span><span class="o">$</span><span class="n">avg_log2FC</span><span class="p">)),</span> <span class="nf">max</span><span class="p">(</span><span class="nf">abs</span><span class="p">(</span><span class="n">degs</span><span class="o">$</span><span class="n">avg_log2FC</span><span class="p">))))</span><span class="c1">#æ²¿yè½´å¯¹ç§°</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#å¯¹Tcellsåœ¨è‚¿ç˜¤ç»„å’Œæ­£å¸¸ç»„ä¹‹é—´çš„å·®å¼‚è¡¨è¾¾åŸºå› è¿›è¡Œå¯è§†åŒ–ï¼Œfig.7.B</span>
</span></span><span class="line"><span class="cl"><span class="n">change</span> <span class="o">=</span> <span class="nf">as.factor</span><span class="p">(</span><span class="nf">ifelse</span><span class="p">(</span><span class="n">Tcell_degs</span><span class="o">$</span><span class="n">p_val_adj</span> <span class="o">&lt;</span> <span class="m">0.05</span> <span class="o">&amp;</span> <span class="nf">abs</span><span class="p">(</span><span class="n">Tcell_degs</span><span class="o">$</span><span class="n">avg_log2FC</span><span class="p">)</span> <span class="o">&gt;</span> <span class="m">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                          <span class="nf">ifelse</span><span class="p">(</span><span class="n">Tcell_degs</span><span class="o">$</span><span class="n">avg_log2FC</span> <span class="o">&gt;</span> <span class="m">1</span> <span class="p">,</span><span class="s">&#39;Up&#39;</span><span class="p">,</span><span class="s">&#39;Down&#39;</span><span class="p">),</span><span class="s">&#39;No change&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">filtered_Tcell_degs</span> <span class="o">=</span> <span class="n">Tcell_degs</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">filter</span><span class="p">(</span><span class="n">p_val_adj</span><span class="o">&lt;</span> <span class="m">0.05</span> <span class="p">)</span><span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">filter</span><span class="p">(</span><span class="nf">abs</span><span class="p">(</span><span class="n">avg_log2FC</span><span class="p">)</span><span class="o">&gt;</span><span class="m">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">Tcell_degs</span><span class="o">$</span><span class="n">label</span> <span class="o">&lt;-</span> <span class="nf">ifelse</span><span class="p">(</span><span class="n">Tcell_degs</span><span class="o">$</span><span class="n">gene</span> <span class="o">%in%</span> <span class="n">filtered_Tcell_degs</span><span class="o">$</span><span class="n">gene</span><span class="p">,</span> <span class="n">Tcell_degs</span><span class="o">$</span><span class="n">gene</span><span class="p">,</span> <span class="kc">NA</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="s">&#34;T_vol.pdf&#34;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="m">5</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="m">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">Tcell_degs</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">avg_log2FC</span><span class="p">,</span> <span class="o">-</span><span class="nf">log10</span><span class="p">(</span><span class="n">p_val_adj</span><span class="p">)))</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_hline</span><span class="p">(</span><span class="n">yintercept</span> <span class="o">=</span> <span class="o">-</span><span class="nf">log10</span><span class="p">(</span><span class="m">0.05</span><span class="p">),</span> <span class="n">linetype</span> <span class="o">=</span> <span class="s">&#34;dashed&#34;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&#34;#999999&#34;</span><span class="p">)</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">),</span> <span class="n">linetype</span> <span class="o">=</span> <span class="s">&#34;dashed&#34;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&#34;#999999&#34;</span><span class="p">)</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_point</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="n">change</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">             <span class="n">size</span> <span class="o">=</span> <span class="m">0.2</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">             <span class="n">alpha</span> <span class="o">=</span> <span class="m">0.5</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">theme_bw</span><span class="p">(</span><span class="n">base_size</span> <span class="o">=</span> <span class="m">12</span><span class="p">)</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_text_repel</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span><span class="p">),</span> 
</span></span><span class="line"><span class="cl">                  <span class="n">size</span> <span class="o">=</span> <span class="m">3</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                  <span class="n">box.padding</span> <span class="o">=</span> <span class="m">0.2</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                  <span class="n">max.overlaps</span> <span class="o">=</span> <span class="m">10</span><span class="p">)</span> <span class="o">+</span> <span class="c1"># é˜²æ­¢é‡å </span>
</span></span><span class="line"><span class="cl">  <span class="nf">scale_color_manual</span><span class="p">(</span><span class="n">values</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;Up&#34;</span> <span class="o">=</span> <span class="s">&#34;red&#34;</span><span class="p">,</span> <span class="s">&#34;Down&#34;</span> <span class="o">=</span> <span class="s">&#34;blue&#34;</span><span class="p">,</span> <span class="s">&#34;No change&#34;</span> <span class="o">=</span> <span class="s">&#34;gray&#34;</span><span class="p">))</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">theme</span><span class="p">(</span><span class="n">panel.grid</span> <span class="o">=</span> <span class="nf">element_blank</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">        <span class="n">legend.position</span> <span class="o">=</span> <span class="s">&#39;right&#39;</span><span class="p">)</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scale_x_continuous</span><span class="p">(</span><span class="n">limits</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="o">-</span><span class="nf">max</span><span class="p">(</span><span class="nf">abs</span><span class="p">(</span><span class="n">Tcell_degs</span><span class="o">$</span><span class="n">avg_log2FC</span><span class="p">)),</span> <span class="nf">max</span><span class="p">(</span><span class="nf">abs</span><span class="p">(</span><span class="n">Tcell_degs</span><span class="o">$</span><span class="n">avg_log2FC</span><span class="p">))))</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#å°æç´å›¾ï¼Œå¯¹æ¯ä¸ªç±»åˆ«çš„top3è¡¨è¾¾åŸºå› è¿›è¡Œå¯è§†åŒ–ï¼Œfig.7.C</span>
</span></span><span class="line"><span class="cl"><span class="n">celldiff_top3</span> <span class="o">&lt;-</span> <span class="n">cell.markers</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">filter</span><span class="p">(</span><span class="n">avg_log2FC</span> <span class="o">&gt;</span> <span class="m">0</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">group_by</span><span class="p">(</span><span class="n">cluster</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">filter</span><span class="p">(</span><span class="n">avg_log2FC</span> <span class="o">&gt;</span><span class="m">3</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">top_n</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="o">-</span><span class="n">p_val_adj</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">group_by</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">VlnPlot</span><span class="p">(</span><span class="n">pbmc_2</span><span class="p">,</span><span class="n">features</span> <span class="o">=</span> <span class="n">celldiff_top3</span><span class="o">$</span><span class="n">gene</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">group.by</span> <span class="o">=</span> <span class="s">&#34;cell_type&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">split.plot</span> <span class="o">=</span> <span class="bp">T</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">split.by</span> <span class="o">=</span> <span class="s">&#39;type&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">cols</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#39;olivedrab&#39;</span><span class="p">,</span><span class="s">&#39;salmon&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="n">stack</span> <span class="o">=</span> <span class="bp">T</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">flip</span> <span class="o">=</span> <span class="bp">T</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggsave</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="s">&#39;vlnplot_celldiff_top3gene.pdf&#39;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">8</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="m">14</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="å›¾ç‰‡-6">å›¾ç‰‡
</h3><p><img src="/p/none/fig.7.jpg"
	width="2480"
	height="5489"
	srcset="/p/none/fig.7_hu160999817354496713.jpg 480w, /p/none/fig.7_hu2488289755726979309.jpg 1024w"
	loading="lazy"
	
		alt="fig.7"
	
	
		class="gallery-image" 
		data-flex-grow="45"
		data-flex-basis="108px"
	
></p>
<h2 id="gokegggseaå¯Œé›†åˆ†æ">GOã€KEGGã€GSEAå¯Œé›†åˆ†æ
</h2><h3 id="è¯´æ˜-8">è¯´æ˜
</h3><h3 id="ä»£ç -8">ä»£ç 
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-R" data-lang="R"><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">clusterProfiler</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">enrichplot</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">Idents</span><span class="p">(</span><span class="n">pbmc_2</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="s">&#34;cell_type&#34;</span> <span class="c1">#å°†cell_typeè®¾ç½®ä¸ºä¸»è¦çš„åˆ†ç±»æ ‡ç­¾</span>
</span></span><span class="line"><span class="cl"><span class="n">cell.markers</span> <span class="o">&lt;-</span> <span class="nf">FindAllMarkers</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">object</span> <span class="o">=</span> <span class="n">pbmc_2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">only.pos</span> <span class="o">=</span> <span class="bp">F</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">test.use</span> <span class="o">=</span> <span class="s">&#39;wilcox&#39;</span><span class="p">,</span> <span class="c1">#æ£€éªŒæ–¹æ³•æ˜¯wilcoxæ£€éªŒ</span>
</span></span><span class="line"><span class="cl">  <span class="n">slot</span> <span class="o">=</span> <span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="c1">#é»˜è®¤ä½¿ç”¨dataè€Œä¸æ˜¯counts</span>
</span></span><span class="line"><span class="cl">  <span class="n">min.pct</span> <span class="o">=</span> <span class="m">0.25</span><span class="p">,</span> <span class="c1">#åœ¨è‡³å°‘25%çš„ç»†èƒå†…è¡¨è¾¾</span>
</span></span><span class="line"><span class="cl">  <span class="n">logfc.threshold</span> <span class="o">=</span> <span class="m">0.25</span> <span class="c1">#è®¾ç½®log2FCçš„é˜ˆå€¼</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#è¿™é‡Œé€‰æ‹©åˆ†ç¾¤æ³¨é‡Šæ—¶æœªèƒ½æˆåŠŸåˆ†ç¾¤çš„Unknownç¾¤åšå¯Œé›†åˆ†æï¼Œå®é™…åº”ç”¨æ—¶å¯é€‰æ‹©ä»»æ„æ„Ÿå…´è¶£çš„äºšç¾¤</span>
</span></span><span class="line"><span class="cl"><span class="n">Unknown_degs</span> <span class="o">=</span> <span class="n">cell.markers</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">filter</span><span class="p">(</span><span class="n">cluster</span> <span class="o">==</span> <span class="s">&#34;Unknown&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">filter</span><span class="p">(</span><span class="n">p_val_adj</span> <span class="o">&lt;</span> <span class="m">0.05</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">filter</span><span class="p">(</span><span class="nf">abs</span><span class="p">(</span><span class="n">avg_log2FC</span><span class="p">)</span> <span class="o">&gt;</span> <span class="m">1</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">arrange</span><span class="p">(</span><span class="nf">desc</span><span class="p">(</span><span class="n">avg_log2FC</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">GO_database</span> <span class="o">&lt;-</span> <span class="s">&#39;org.Hs.eg.db&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#å°†SYMBOLè½¬ENTREZID</span>
</span></span><span class="line"><span class="cl"><span class="n">ENTgene</span> <span class="o">&lt;-</span> <span class="nf">bitr</span><span class="p">(</span><span class="n">Unknown_degs</span><span class="o">$</span><span class="n">gene</span><span class="p">,</span> <span class="n">fromType</span> <span class="o">=</span> <span class="s">&#39;SYMBOL&#39;</span><span class="p">,</span> <span class="n">toType</span> <span class="o">=</span> <span class="s">&#39;ENTREZID&#39;</span><span class="p">,</span> <span class="n">OrgDb</span> <span class="o">=</span> <span class="n">GO_database</span><span class="p">,</span><span class="n">drop</span> <span class="o">=</span> <span class="bp">F</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">distinct</span><span class="p">(</span><span class="n">SYMBOL</span><span class="p">,</span><span class="n">.keep_all</span> <span class="o">=</span> <span class="bp">T</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">drop_na</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">ENTgene</span> <span class="o">&lt;-</span> <span class="n">dplyr</span><span class="o">::</span><span class="nf">distinct</span><span class="p">(</span><span class="n">ENTgene</span><span class="p">,</span><span class="n">SYMBOL</span><span class="p">,</span><span class="n">.keep_all</span> <span class="o">=</span> <span class="bp">T</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">###GOå¯Œé›†åˆ†æ,ä½¿ç”¨enrichGOå‡½æ•°###</span>
</span></span><span class="line"><span class="cl"><span class="n">GO</span> <span class="o">&lt;-</span> <span class="nf">enrichGO</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">ENTgene</span><span class="o">$</span><span class="n">ENTREZID</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">OrgDb</span> <span class="o">=</span> <span class="n">GO_database</span><span class="p">,</span> <span class="c1">#å³&#39;org.Hs.eg.db&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="n">keyType</span> <span class="o">=</span> <span class="s">&#34;ENTREZID&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">ont</span> <span class="o">=</span> <span class="s">&#34;all&#34;</span><span class="p">,</span>  <span class="c1"># è·å–BP, CC, MFæ‰€æœ‰æœ¬ä½“è®ºçš„å¯Œé›†ç»“æœ</span>
</span></span><span class="line"><span class="cl">  <span class="n">pvalueCutoff</span> <span class="o">=</span> <span class="m">0.01</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">qvalueCutoff</span> <span class="o">=</span> <span class="m">0.01</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">readable</span> <span class="o">=</span> <span class="bp">T</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#å¯è§†åŒ–barplotï¼Œfig.8.A</span>
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="s">&#34;GO_Enrichment_all_ontology.pdf&#34;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="m">8</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="m">12</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">barplot</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">GO</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">split</span><span class="o">=</span><span class="s">&#34;ONTOLOGY&#34;</span><span class="p">,</span> <span class="c1">#æŒ‰åŸºå› æœ¬ä½“è®ºåˆ†ç»„</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span><span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">ONTOLOGY</span><span class="p">,</span> <span class="n">scales</span><span class="o">=</span><span class="s">&#34;free&#34;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="m">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#å¯è§†åŒ–dotplotï¼Œfig.8.B</span>
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="s">&#34;GO_Enrichment_all_ontology_dot.pdf&#34;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="m">10</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="m">20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">dotplot</span><span class="p">(</span><span class="n">GO</span><span class="p">,</span><span class="n">split</span> <span class="o">=</span> <span class="s">&#34;ONTOLOGY&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">###KEGGåˆ†æ###</span>
</span></span><span class="line"><span class="cl"><span class="n">KEGG_database</span> <span class="o">=</span> <span class="s">&#39;hsa&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">kegg_data</span> <span class="o">&lt;-</span> <span class="nf">enrichKEGG</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">gene</span> <span class="o">=</span> <span class="n">ENTgene</span><span class="o">$</span><span class="n">ENTREZID</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">keyType</span> <span class="o">=</span> <span class="s">&#39;kegg&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">organism</span> <span class="o">=</span> <span class="n">KEGG_database</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">pvalueCutoff</span> <span class="o">=</span> <span class="m">0.05</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">qvalueCutoff</span> <span class="o">=</span> <span class="m">0.05</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">use_internal_data</span> <span class="o">=</span> <span class="bp">F</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">setReadable</span><span class="p">(</span><span class="n">.,OrgDb</span> <span class="o">=</span> <span class="n">GO_database</span><span class="p">,</span><span class="n">keyType</span> <span class="o">=</span> <span class="s">&#39;ENTREZID&#39;</span><span class="p">)</span> <span class="c1">#%&gt;%</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">enrichplot</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">kegg_data</span> <span class="o">=</span> <span class="nf">setReadable</span><span class="p">(</span><span class="n">kegg_data</span><span class="p">,</span> <span class="c1">#å‰é¢åˆ†æçš„ç»“æœ</span>
</span></span><span class="line"><span class="cl">                  <span class="n">OrgDb</span> <span class="o">=</span> <span class="s">&#34;org.Hs.eg.db&#34;</span><span class="p">,</span> <span class="c1">#äººç±»æ•°æ®åº“</span>
</span></span><span class="line"><span class="cl">                  <span class="n">keyType</span> <span class="o">=</span> <span class="s">&#34;ENTREZID&#34;</span><span class="p">)</span> <span class="c1">#è¦è½¬æ¢çš„åŸºå› ç±»å‹</span>
</span></span><span class="line"><span class="cl"><span class="nf">write.table</span><span class="p">(</span><span class="n">kegg_data</span><span class="p">,</span><span class="n">file</span><span class="o">=</span><span class="s">&#34;kegg_data.txt&#34;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s">&#34;\t&#34;</span><span class="p">,</span><span class="n">quote</span><span class="o">=</span><span class="bp">F</span><span class="p">,</span><span class="n">row.names</span> <span class="o">=</span> <span class="bp">F</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl"><span class="c1">#å¯è§†åŒ–barplotï¼Œfig.8.C</span>
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s">&#34;kegg_barplot.pdf&#34;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">7</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="m">5</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="nf">barplot</span><span class="p">(</span><span class="n">kegg_data</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s">&#34;GeneRatio&#34;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&#34;p.adjust&#34;</span><span class="p">,</span> <span class="c1">#é»˜è®¤å‚æ•°</span>
</span></span><span class="line"><span class="cl">        <span class="n">showCategory</span> <span class="o">=</span><span class="m">10</span><span class="p">)</span> <span class="c1">#åªæ˜¾ç¤ºå‰10</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#å¯è§†åŒ–dotplotï¼Œfig.8.D</span>
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s">&#34;kegg_dotplot.pdf&#34;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">7</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="m">5</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="nf">dotplot</span><span class="p">(</span><span class="n">kegg_data</span><span class="p">,</span><span class="n">x</span> <span class="o">=</span> <span class="s">&#34;GeneRatio&#34;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&#34;p.adjust&#34;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="s">&#34;Count&#34;</span><span class="p">,</span> <span class="c1">#é»˜è®¤å‚æ•°</span>
</span></span><span class="line"><span class="cl">        <span class="n">showCategory</span> <span class="o">=</span> <span class="m">10</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#å¯è§†åŒ–colored cnetplotï¼Œfig.8.E</span>
</span></span><span class="line"><span class="cl"><span class="n">Unknown_degs</span><span class="o">$</span><span class="n">SYMBOL</span> <span class="o">=</span> <span class="n">Unknown_degs</span><span class="o">$</span><span class="n">gene</span>
</span></span><span class="line"><span class="cl"><span class="n">cnet_data</span> <span class="o">=</span> <span class="nf">merge</span><span class="p">(</span><span class="n">Unknown_degs</span><span class="p">,</span><span class="n">ENTgene</span><span class="p">,</span><span class="n">by</span> <span class="o">=</span> <span class="s">&#34;SYMBOL&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">cnet_data</span> <span class="o">=</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">cnet_data</span><span class="o">$</span><span class="n">ENTREZID</span><span class="p">,</span><span class="n">cnet_data</span><span class="o">$</span><span class="n">gene</span><span class="p">,</span><span class="n">cnet_data</span><span class="o">$</span><span class="n">avg_log2FC</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">logFC</span> <span class="o">&lt;-</span> <span class="n">cnet_data</span><span class="o">$</span><span class="n">cnet_data.avg_log2FC</span>
</span></span><span class="line"><span class="cl"><span class="nf">names</span><span class="p">(</span><span class="n">logFC</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="n">cnet_data</span><span class="o">$</span><span class="n">cnet_data.gene</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s">&#34;colored_kegg_cnetplot.pdf&#34;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">10</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="m">10</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="nf">cnetplot</span><span class="p">(</span><span class="n">kegg_data</span><span class="p">,</span> <span class="n">showCategory</span> <span class="o">=</span> <span class="m">8</span><span class="p">,</span> <span class="c1">#é€‰æ‹©top8çš„pathway ï¼Œè¿™é‡Œä¹Ÿå¯ä»¥ç”¨åŒ…å«pathwayåç§°çš„å‘é‡           </span>
</span></span><span class="line"><span class="cl">         <span class="n">foldChange</span> <span class="o">=</span> <span class="n">logFC</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">colorEdge</span> <span class="o">=</span> <span class="bp">T</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">node_label</span> <span class="o">=</span> <span class="s">&#39;all&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">max.overlaps</span> <span class="o">=</span> <span class="m">50</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">###GSEAåˆ†æ###</span>
</span></span><span class="line"><span class="cl"><span class="n">expr_matrix</span> <span class="o">=</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">Unknown_degs</span><span class="o">$</span><span class="n">SYMBOL</span><span class="p">,</span><span class="n">Unknown_degs</span><span class="o">$</span><span class="n">avg_log2FC</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">colnames</span><span class="p">(</span><span class="n">expr_matrix</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;SYMBOL&#34;</span><span class="p">,</span><span class="s">&#34;Log2FoldChange&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">merged_matrix</span> <span class="o">=</span> <span class="nf">merge</span><span class="p">(</span><span class="n">expr_matrix</span><span class="p">,</span><span class="n">ENTgene</span><span class="p">,</span><span class="n">by</span> <span class="o">=</span> <span class="s">&#34;SYMBOL&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">data_sort</span> <span class="o">&lt;-</span> <span class="nf">arrange</span><span class="p">(</span><span class="n">merged_matrix</span><span class="p">,</span><span class="nf">desc</span><span class="p">(</span><span class="n">Log2FoldChange</span><span class="p">))</span> <span class="c1">#log2FCè¿›è¡Œæ’åºï¼Œè¿™æ˜¯GSEAåˆ†æå¿…è¦çš„</span>
</span></span><span class="line"><span class="cl"><span class="n">gene_list</span> <span class="o">&lt;-</span> <span class="n">data_sort</span><span class="o">$</span><span class="n">Log2FoldChange</span>
</span></span><span class="line"><span class="cl"><span class="nf">names</span><span class="p">(</span><span class="n">gene_list</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="n">data_sort</span><span class="o">$</span><span class="n">ENTREZID</span>
</span></span><span class="line"><span class="cl"><span class="n">KEGG_database</span> <span class="o">=</span> <span class="s">&#39;hsa&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">gsea</span> <span class="o">&lt;-</span> <span class="nf">gseKEGG</span><span class="p">(</span><span class="n">gene_list</span><span class="p">,</span><span class="n">organism</span> <span class="o">=</span> <span class="n">KEGG_database</span><span class="p">,</span> <span class="n">pvalueCutoff</span> <span class="o">=</span> <span class="m">0.05</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">gsea</span> <span class="o">=</span> <span class="nf">setReadable</span><span class="p">(</span><span class="n">gsea</span><span class="p">,</span> <span class="n">OrgDb</span> <span class="o">=</span> <span class="n">GO_database</span><span class="p">,</span> <span class="n">keyType</span> <span class="o">=</span> <span class="s">&#34;ENTREZID&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#å¯è§†åŒ–</span>
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s">&#34;gsea_dotplot.pdf&#34;</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="m">12</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="m">10</span><span class="p">)</span> <span class="c1">#fig.8.F</span>
</span></span><span class="line"><span class="cl"><span class="nf">dotplot</span><span class="p">(</span><span class="n">gsea</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s">&#34;gsea_ridgeplot.pdf&#34;</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="m">12</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="m">10</span><span class="p">)</span> <span class="c1">#fig.8.G</span>
</span></span><span class="line"><span class="cl"><span class="nf">ridgeplot</span><span class="p">(</span><span class="n">gsea</span><span class="p">,</span><span class="n">label_format</span> <span class="o">=</span> <span class="m">100</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s">&#34;gsea_gseaplot.pdf&#34;</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="m">12</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="m">10</span><span class="p">)</span> <span class="c1">#fig.8.H</span>
</span></span><span class="line"><span class="cl"><span class="nf">gseaplot2</span><span class="p">(</span><span class="n">gsea</span><span class="p">,</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">),</span><span class="n">pvalue_table</span> <span class="o">=</span> <span class="bp">F</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">###pathview###</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">pathview</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">pathview_data</span> <span class="o">=</span> <span class="n">Unknown_degs</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">filter</span><span class="p">(</span><span class="n">Unknown_degs</span><span class="o">$</span><span class="n">gene</span> <span class="o">%in%</span> <span class="nf">as.factor</span><span class="p">(</span><span class="n">ENTgene</span><span class="o">$</span><span class="n">SYMBOL</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">pathview_data</span><span class="o">$</span><span class="n">SYMBOL</span> <span class="o">=</span> <span class="n">pathview_data</span><span class="o">$</span><span class="n">gene</span>
</span></span><span class="line"><span class="cl"><span class="n">pathview_data</span> <span class="o">=</span> <span class="nf">merge</span><span class="p">(</span><span class="n">pathview_data</span><span class="p">,</span><span class="n">ENTgene</span><span class="p">,</span><span class="n">by</span> <span class="o">=</span> <span class="s">&#39;SYMBOL&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">pathview_data_draw</span> <span class="o">=</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">pathview_data</span><span class="o">$</span><span class="n">ENTREZID</span><span class="p">,</span><span class="n">pathview_data</span><span class="o">$</span><span class="n">avg_log2FC</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="nf">rownames</span><span class="p">(</span><span class="n">pathview_data_draw</span><span class="p">)</span> <span class="o">=</span> <span class="n">pathview_data_draw</span><span class="o">$</span><span class="n">pathview_data.ENTREZID</span>
</span></span><span class="line"><span class="cl"><span class="nf">colnames</span><span class="p">(</span><span class="n">pathview_data_draw</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#39;ENTREZID&#39;</span><span class="p">,</span><span class="s">&#39;log2FC&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">pathview_data_draw</span><span class="o">$</span><span class="n">ENTREZID</span> <span class="o">&lt;-</span> <span class="nf">as.numeric</span><span class="p">(</span><span class="n">pathview_data_draw</span><span class="o">$</span><span class="n">ENTREZID</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#ç»˜å›¾æ•°æ®æ˜¯ä¸ªdataframeï¼Œè¡Œåæ˜¯ENTREZIDï¼Œä¸¤åˆ—åˆ†åˆ«æ˜¯ENTREZIDå’Œlog2FC</span>
</span></span><span class="line"><span class="cl"><span class="c1">#fig.8.I</span>
</span></span><span class="line"><span class="cl"><span class="nf">pathview</span><span class="p">(</span><span class="n">gene.data</span> <span class="o">=</span> <span class="n">pathview_data_draw</span><span class="p">,</span> <span class="c1">#ä¸Šé¢åŒ…å«è¡Œåä¸ºentrezIDçš„logFCå€¼çš„æ•°æ®æ¡†</span>
</span></span><span class="line"><span class="cl">         <span class="n">pathway.id</span> <span class="o">=</span> <span class="s">&#34;hsa04650&#34;</span><span class="p">,</span> <span class="c1">#é€‰æ‹©ä¸€ä¸ªKEGGä¿¡å·é€šè·¯,è¿™é‡Œé€‰çš„æ˜¯hsa04650ã€‚æ›´å¤šé€šè·¯è§KEGGå®˜ç½‘</span>
</span></span><span class="line"><span class="cl">         <span class="n">species</span> <span class="o">=</span> <span class="s">&#34;hsa&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">out.suffix</span> <span class="o">=</span> <span class="s">&#34;Unknown1&#34;</span><span class="p">,</span> <span class="c1">#è¾“å‡ºæ–‡ä»¶å</span>
</span></span><span class="line"><span class="cl">         <span class="n">kegg.native</span> <span class="o">=</span> <span class="bp">T</span>
</span></span><span class="line"><span class="cl">         <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#fig.8.J</span>
</span></span><span class="line"><span class="cl"><span class="nf">pathview</span><span class="p">(</span><span class="n">gene.data</span> <span class="o">=</span> <span class="n">pathview_data_draw</span><span class="p">,</span> <span class="c1">#ä¸Šé¢åŒ…å«è¡Œåä¸ºentrezIDçš„logFCå€¼çš„æ•°æ®æ¡†</span>
</span></span><span class="line"><span class="cl">         <span class="n">pathway.id</span> <span class="o">=</span> <span class="s">&#34;hsa04650&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">         <span class="n">species</span> <span class="o">=</span> <span class="s">&#34;hsa&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">out.suffix</span> <span class="o">=</span> <span class="s">&#34;Unknown2&#34;</span><span class="p">,</span> <span class="c1">#è¾“å‡ºæ–‡ä»¶å</span>
</span></span><span class="line"><span class="cl">         <span class="n">kegg.native</span> <span class="o">=</span> <span class="bp">F</span> <span class="c1">#ä»¥pdfä¿å­˜ï¼Œä½†æ˜¯æ ¼å¼å¯èƒ½ä¸å¥½çœ‹</span>
</span></span><span class="line"><span class="cl">         <span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="cell-chatåˆ†æ">Cell Chatåˆ†æ
</h2><h3 id="è¯´æ˜-9">è¯´æ˜
</h3><h3 id="ä»£ç -9">ä»£ç 
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-R" data-lang="R"><span class="line"><span class="cl"><span class="kr">if</span> <span class="p">(</span><span class="o">!</span><span class="nf">require</span><span class="p">(</span><span class="n">CellChat</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">  <span class="n">devtools</span><span class="o">::</span><span class="nf">install_github</span><span class="p">(</span><span class="s">&#34;jinworks/CellChat&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">devtools</span><span class="o">::</span><span class="nf">install_github</span><span class="p">(</span><span class="s">&#39;immunogenomics/presto&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">CellChat</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">patchwork</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">data.input</span> <span class="o">&lt;-</span> <span class="n">pbmc_2[[</span><span class="s">&#34;RNA&#34;</span><span class="n">]]</span><span class="o">$</span><span class="n">data</span> <span class="c1">#æå–è¡¨è¾¾çŸ©é˜µ</span>
</span></span><span class="line"><span class="cl"><span class="n">labels</span> <span class="o">&lt;-</span> <span class="nf">Idents</span><span class="p">(</span><span class="n">pbmc_2</span><span class="p">)</span> <span class="c1">#æå–ä¸»è¦åˆ†ç±»æ ‡ç­¾ï¼Œè¿™é‡Œæ˜¯cell_type</span>
</span></span><span class="line"><span class="cl"><span class="n">meta</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="p">,</span> <span class="n">row.names</span> <span class="o">=</span> <span class="nf">names</span><span class="p">(</span><span class="n">labels</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">cellchat</span> <span class="o">&lt;-</span> <span class="nf">createCellChat</span><span class="p">(</span><span class="n">object</span> <span class="o">=</span> <span class="n">pbmc_2</span><span class="p">,</span> <span class="n">group.by</span> <span class="o">=</span> <span class="s">&#34;ident&#34;</span><span class="p">,</span> <span class="n">assay</span> <span class="o">=</span> <span class="s">&#34;RNA&#34;</span><span class="p">)</span> <span class="c1">#æ„å»ºcellchatå¯¹è±¡</span>
</span></span><span class="line"><span class="cl"><span class="n">CellChatDB</span> <span class="o">&lt;-</span> <span class="n">CellChatDB.human</span> <span class="c1">#é€‰æ‹©äººç±»æ•°æ®åº“</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#å±•ç¤ºè¯¥æ•°æ®åº“ä¸­çš„æ•°æ®ç±»åˆ«çš„æ„æˆæ¯”ï¼Œfig.9.A</span>
</span></span><span class="line"><span class="cl"><span class="nf">showDatabaseCategory</span><span class="p">(</span><span class="n">CellChatDB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggsave</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s">&#39;DBcategory.pdf&#39;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">6</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="m">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#æå–æ•°æ®åº“çš„å­é›†ï¼Œé€‰æ‹©â€œSevreted Signalingâ€éƒ¨åˆ†</span>
</span></span><span class="line"><span class="cl"><span class="n">CellChatDB.use</span> <span class="o">&lt;-</span> <span class="nf">subsetDB</span><span class="p">(</span><span class="n">CellChatDB</span><span class="p">,</span> <span class="n">search</span> <span class="o">=</span> <span class="s">&#34;Secreted Signaling&#34;</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="s">&#34;annotation&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">cellchat</span><span class="o">@</span><span class="n">DB</span> <span class="o">&lt;-</span> <span class="n">CellChatDB.use</span> <span class="c1">#å°†æ•°æ®åº“æ›´æ–°åˆ°cellchatå¯¹è±¡ä¸­</span>
</span></span><span class="line"><span class="cl"><span class="n">cellchat</span> <span class="o">&lt;-</span> <span class="nf">subsetData</span><span class="p">(</span><span class="n">cellchat</span><span class="p">)</span> <span class="c1">#ä»è¾“å…¥æ•°æ®ä¸­æå–ä¸ä¿¡å·é€šè·¯ç›¸å…³çš„é…ä½“å’Œå—ä½“åŸºå› ï¼Œä¸èƒ½çœç•¥</span>
</span></span><span class="line"><span class="cl"><span class="n">cellchat</span> <span class="o">&lt;-</span> <span class="nf">identifyOverExpressedGenes</span><span class="p">(</span><span class="n">cellchat</span><span class="p">)</span> <span class="c1">#è¯†åˆ«åœ¨å„ç¾¤ä½“ä¸­è¿‡è¡¨è¾¾çš„åŸºå› </span>
</span></span><span class="line"><span class="cl"><span class="n">cellchat</span> <span class="o">&lt;-</span> <span class="nf">identifyOverExpressedInteractions</span><span class="p">(</span><span class="n">cellchat</span><span class="p">)</span> <span class="c1">#æ ¹æ®è¿‡è¡¨è¾¾åŸºå› æ¨æ–­æ½œåœ¨çš„ç»†èƒç›¸äº’ä½œç”¨</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#ä½¿ç”¨äººç±»è›‹ç™½è´¨ç›¸äº’ä½œç”¨ï¼ˆPPIï¼‰ç½‘ç»œå¹³æ»‘ä¿¡å·æ•°æ®ï¼Œæ”¹è¿›å™ªå£°æ¨¡å‹</span>
</span></span><span class="line"><span class="cl"><span class="n">cellchat</span> <span class="o">&lt;-</span> <span class="nf">smoothData</span><span class="p">(</span><span class="n">cellchat</span><span class="p">,</span> <span class="n">adj</span> <span class="o">=</span> <span class="n">PPI.human</span><span class="p">)</span> <span class="c1">#cellchatåŒ…ä½œè€…æŠŠprojectDataå‡½æ•°æ”¹ä¸ºäº†smoothDataå‡½æ•°!</span>
</span></span><span class="line"><span class="cl"><span class="n">cellchat</span> <span class="o">&lt;-</span> <span class="nf">computeCommunProb</span><span class="p">(</span><span class="n">cellchat</span><span class="p">,</span> <span class="n">type</span> <span class="o">=</span> <span class="s">&#34;triMean&#34;</span><span class="p">)</span> <span class="c1">#è®¡ç®—ç»†èƒé—´çš„é€šä¿¡æ¦‚ç‡ï¼Œä½¿ç”¨ä¸‰å‡å€¼æ³•ä½œä¸ºä¼°ç®—æ–¹å¼</span>
</span></span><span class="line"><span class="cl"><span class="n">cellchat</span> <span class="o">&lt;-</span> <span class="nf">filterCommunication</span><span class="p">(</span><span class="n">cellchat</span><span class="p">,</span> <span class="n">min.cells</span> <span class="o">=</span> <span class="m">10</span><span class="p">)</span> <span class="c1">#ç­›é€‰é€šä¿¡äº‹ä»¶ï¼Œä¿ç•™è‡³å°‘åœ¨ 10 ä¸ªç»†èƒä¸­æ£€æµ‹åˆ°çš„é€šä¿¡å¯¹</span>
</span></span><span class="line"><span class="cl"><span class="n">cellchat</span> <span class="o">&lt;-</span> <span class="nf">computeCommunProbPathway</span><span class="p">(</span><span class="n">cellchat</span><span class="p">)</span> <span class="c1">#è®¡ç®—ç»†èƒé—´é€šè®¯çš„è·¯å¾„æ¦‚ç‡</span>
</span></span><span class="line"><span class="cl"><span class="n">cellchat</span> <span class="o">&lt;-</span> <span class="nf">aggregateNet</span><span class="p">(</span><span class="n">cellchat</span><span class="p">)</span><span class="c1">#å°†ç»†èƒé—´é€šè®¯çš„ç½‘ç»œèšåˆåˆ°æ›´é«˜çš„å±‚æ¬¡</span>
</span></span><span class="line"><span class="cl"><span class="n">groupSize</span> <span class="o">&lt;-</span> <span class="nf">as.numeric</span><span class="p">(</span><span class="nf">table</span><span class="p">(</span><span class="n">cellchat</span><span class="o">@</span><span class="n">idents</span><span class="p">))</span><span class="c1">#è®¡ç®—æ¯ç§ç»†èƒç±»å‹çš„ç»†èƒæ•°</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#ç»˜åˆ¶å¼¦å›¾ï¼Œfig.9.B</span>
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s">&#34;Interactions_string.pdf&#34;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">5</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="m">5</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="nf">netVisual_circle</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">cellchat</span><span class="o">@</span><span class="n">net</span><span class="o">$</span><span class="n">count</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">  <span class="n">vertex.weight</span> <span class="o">=</span> <span class="n">groupSize</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">  <span class="n">weight.scale</span> <span class="o">=</span> <span class="bp">T</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">  <span class="n">label.edge</span><span class="o">=</span> <span class="bp">F</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">  <span class="n">title.name</span> <span class="o">=</span> <span class="s">&#34;Number of interactions&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#ç»˜åˆ¶å¼¦å›¾ï¼Œçº¿çš„ç²—ç»†ä¸ºweights/strengthï¼Œfig.9.C</span>
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s">&#34;Interactions_string_W_S.pdf&#34;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">5</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="m">5</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="nf">netVisual_circle</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">cellchat</span><span class="o">@</span><span class="n">net</span><span class="o">$</span><span class="n">weight</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">  <span class="n">vertex.weight</span> <span class="o">=</span> <span class="n">groupSize</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">  <span class="n">weight.scale</span> <span class="o">=</span> <span class="bp">T</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">  <span class="n">label.edge</span><span class="o">=</span> <span class="bp">F</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">  <span class="n">title.name</span> <span class="o">=</span> <span class="s">&#34;Interaction weights/strength&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#ç»˜åˆ¶æ¯ä¸€ä¸ªç±»å‹çš„ç»†èƒä¸æ‰€æœ‰çš„ç»†èƒä¹‹é—´çš„é€šè®¯æƒ…å†µï¼Œfig.9.D</span>
</span></span><span class="line"><span class="cl"><span class="n">mat</span> <span class="o">&lt;-</span> <span class="n">cellchat</span><span class="o">@</span><span class="n">net</span><span class="o">$</span><span class="n">weight</span>
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s">&#39;plot_all.pdf&#39;</span><span class="p">,</span><span class="m">12</span><span class="p">,</span><span class="m">6</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">par</span><span class="p">(</span><span class="n">mfrow</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">4</span><span class="p">),</span> <span class="n">xpd</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">for</span> <span class="p">(</span><span class="n">i</span> <span class="kr">in</span> <span class="m">1</span><span class="o">:</span><span class="nf">nrow</span><span class="p">(</span><span class="n">mat</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">mat2</span> <span class="o">&lt;-</span> <span class="nf">matrix</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="n">nrow</span> <span class="o">=</span> <span class="nf">nrow</span><span class="p">(</span><span class="n">mat</span><span class="p">),</span> <span class="n">ncol</span> <span class="o">=</span> <span class="nf">ncol</span><span class="p">(</span><span class="n">mat</span><span class="p">),</span> <span class="n">dimnames</span> <span class="o">=</span> <span class="nf">dimnames</span><span class="p">(</span><span class="n">mat</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="n">mat2[i</span><span class="p">,</span> <span class="n">]</span> <span class="o">&lt;-</span> <span class="n">mat[i</span><span class="p">,</span> <span class="n">]</span>
</span></span><span class="line"><span class="cl">  <span class="nf">netVisual_circle</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">mat2</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">    <span class="n">vertex.weight</span> <span class="o">=</span> <span class="n">groupSize</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">    <span class="n">weight.scale</span> <span class="o">=</span> <span class="bp">T</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">    <span class="n">edge.weight.max</span> <span class="o">=</span> <span class="nf">max</span><span class="p">(</span><span class="n">mat</span><span class="p">),</span> 
</span></span><span class="line"><span class="cl">    <span class="n">title.name</span> <span class="o">=</span> <span class="nf">rownames</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span><span class="n">[i]</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#å•ç‹¬æ˜¾ç¤ºä¸€æ¡é€šè·¯ï¼Œè¿™é‡Œé€‰æ‹©MIFé€šè·¯ã€‚ç»˜åˆ¶å¼¦å›¾ï¼Œfig.9.E</span>
</span></span><span class="line"><span class="cl"><span class="n">cellchat</span><span class="o">@</span><span class="n">netP</span><span class="o">$</span><span class="n">pathways</span><span class="c1">#æ¶‰åŠåˆ°çš„æ‰€æœ‰çš„pathway</span>
</span></span><span class="line"><span class="cl"><span class="n">pathways.show</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;MIF&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="s">&#39;MIF signaling pathway network2.pdf&#39;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">5</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="m">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">netVisual_aggregate</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">cellchat</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">  <span class="n">signaling</span> <span class="o">=</span> <span class="n">pathways.show</span><span class="p">,</span>  
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#ç»˜åˆ¶å¦ä¸€ç§å¼¦å›¾ï¼Œfig.9.F</span>
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="s">&#39;chord_plot.pdf&#39;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">10</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="m">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">netVisual_aggregate</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">cellchat</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">  <span class="n">signaling</span> <span class="o">=</span> <span class="n">pathways.show</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">  <span class="n">layout</span> <span class="o">=</span> <span class="s">&#34;chord&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#ç»˜åˆ¶çƒ­å›¾ï¼Œfig.9.G</span>
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="s">&#39;heatmap_plot.pdf&#39;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">10</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="m">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">netVisual_heatmap</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">cellchat</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">  <span class="n">signaling</span> <span class="o">=</span> <span class="n">pathways.show</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">  <span class="n">color.heatmap</span> <span class="o">=</span> <span class="s">&#34;Reds&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#è®¡ç®—è¯¥é€šè·¯ï¼ˆMIFï¼‰ä¸­ä¸€äº›äºšå‹çš„è´¡çŒ®å æ¯”</span>
</span></span><span class="line"><span class="cl"><span class="nf">netAnalysis_contribution</span><span class="p">(</span><span class="n">cellchat</span><span class="p">,</span> <span class="n">signaling</span> <span class="o">=</span> <span class="n">pathways.show</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#æå–MIFé€šè·¯ä¸­æ‰€æœ‰äºšå‹</span>
</span></span><span class="line"><span class="cl"><span class="n">pairLR.CXCR4</span> <span class="o">&lt;-</span> <span class="nf">extractEnrichedLR</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">cellchat</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">  <span class="n">signaling</span> <span class="o">=</span> <span class="n">pathways.show</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">  <span class="n">geneLR.return</span> <span class="o">=</span> <span class="kc">FALSE</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#æå–MIF-ï¼ˆCD74+CRCX4ï¼‰é€šè·¯ï¼Œç”»å‡ºæ‰€æœ‰äºšå‹å æ¯”çš„æ¡å½¢å›¾ï¼Œfig.9.H</span>
</span></span><span class="line"><span class="cl"><span class="n">LR.show</span> <span class="o">&lt;-</span> <span class="n">pairLR.CXCR4[1</span><span class="p">,</span><span class="n">]</span> <span class="c1"># show one ligand-receptor pair</span>
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="s">&#39;MIF-CD74+CRCX4_signaling_pathway.pdf&#39;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">5</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="m">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">netVisual_individual</span><span class="p">(</span><span class="n">cellchat</span><span class="p">,</span> <span class="n">signaling</span> <span class="o">=</span> <span class="n">pathways.show</span><span class="p">,</span>  <span class="n">pairLR.use</span> <span class="o">=</span> <span class="n">LR.show</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#å¯è§†åŒ–æ‰€æœ‰é€šè·¯çš„äºšå‹å æ¯”ï¼Œfig.9.I</span>
</span></span><span class="line"><span class="cl"><span class="n">pathways.show.all</span> <span class="o">&lt;-</span> <span class="n">cellchat</span><span class="o">@</span><span class="n">netP</span><span class="o">$</span><span class="n">pathways</span>
</span></span><span class="line"><span class="cl"><span class="n">vertex.receiver</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">for</span> <span class="p">(</span><span class="n">i</span> <span class="kr">in</span> <span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">pathways.show.all</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># Visualize communication network associated with both signaling pathway and individual L-R pairs</span>
</span></span><span class="line"><span class="cl">  <span class="nf">netVisual</span><span class="p">(</span><span class="n">cellchat</span><span class="p">,</span> <span class="n">signaling</span> <span class="o">=</span> <span class="n">pathways.show.all[i]</span><span class="p">,</span> <span class="n">vertex.receiver</span> <span class="o">=</span> <span class="n">vertex.receiver</span><span class="p">,</span> <span class="n">layout</span> <span class="o">=</span> <span class="s">&#34;hierarchy&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># Compute and visualize the contribution of each ligand-receptor pair to the overall signaling pathway</span>
</span></span><span class="line"><span class="cl">  <span class="kr">if</span> <span class="p">(</span><span class="n">i</span><span class="o">==</span><span class="m">1</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="n">gg</span> <span class="o">&lt;-</span> <span class="nf">netAnalysis_contribution</span><span class="p">(</span><span class="n">cellchat</span><span class="p">,</span> <span class="n">signaling</span> <span class="o">=</span> <span class="n">pathways.show.all[i]</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="n">gg</span> <span class="o">&lt;-</span> <span class="n">gg</span><span class="o">+</span><span class="nf">netAnalysis_contribution</span><span class="p">(</span><span class="n">cellchat</span><span class="p">,</span> <span class="n">signaling</span> <span class="o">=</span> <span class="n">pathways.show.all[i]</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="c1">#ggsave(filename=paste0(pathways.show.all[i], &#34;_L-R_contribution.pdf&#34;), plot=gg, width = 3, height = 2, units = &#39;in&#39;, dpi = 300)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggsave</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="s">&#39;contribution_of_each_pathway.pdf&#39;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">14</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="m">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#ç»˜åˆ¶æ°”æ³¡å›¾ï¼Œæœ¬è´¨ä¸å¼¦å›¾ç±»ä¼¼ï¼Œfig.9.J</span>
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="s">&#39;bubble2.pdf&#39;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">5</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="m">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">netVisual_bubble</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">cellchat</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">  <span class="n">sources.use</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">),</span> <span class="c1">#æŒ‡å®šä¿¡å·æ¥æºçš„ç»†èƒç¾¤ä½“</span>
</span></span><span class="line"><span class="cl">  <span class="n">targets.use</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">8</span><span class="p">),</span> <span class="c1">#æŒ‡å®šä¿¡å·æ¥æ”¶çš„ç»†èƒç¾¤ä½“</span>
</span></span><span class="line"><span class="cl">  <span class="n">signaling</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;MIF&#34;</span><span class="p">,</span><span class="s">&#34;CypA&#34;</span><span class="p">),</span> <span class="c1">#æŒ‡å®šå¯è§†åŒ–å“ªäº›ä¿¡å·é€šè·¯</span>
</span></span><span class="line"><span class="cl">  <span class="n">remove.isolate</span> <span class="o">=</span> <span class="kc">FALSE</span> <span class="c1">#ä¸ç§»é™¤ä¿¡å·å¼ºåº¦ä½çš„é€šä¿¡å¯¹</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#æŒ‡å®šæºç»†èƒç¾¤å’Œç›®æ ‡ç»†èƒç¾¤ï¼Œä»¥åŠæŒ‡å®šä¿¡å·é€šè·¯ï¼Œç»˜åˆ¶å¼¦å›¾ï¼Œfig.9.K</span>
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="s">&#39;Tumor_to_all_chord.pdf&#39;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">7</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="m">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">netVisual_chord_gene</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">cellchat</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">  <span class="n">sources.use</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">),</span> <span class="c1">#æŒ‡å®šä¿¡å·æ¥æºçš„ç»†èƒç¾¤ä½“ï¼Œç¼–å·ä¸º 1 åˆ° 8ã€‚</span>
</span></span><span class="line"><span class="cl">  <span class="n">targets.use</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">8</span><span class="p">),</span> <span class="c1">#æŒ‡å®šä¿¡å·æ¥æ”¶çš„ç»†èƒç¾¤ä½“ï¼Œç¼–å·ä¸º 1 åˆ° 8ã€‚</span>
</span></span><span class="line"><span class="cl">  <span class="n">signaling</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;MIF&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">  <span class="n">legend.pos.x</span> <span class="o">=</span> <span class="m">8</span> <span class="c1">#è°ƒæ•´å›¾åœ¨ç”»å¸ƒä¸Šçš„ä½ç½®</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#ç»˜åˆ¶ä¸æŒ‡å®šä¿¡å·é€šè·¯ç›¸å…³çš„åŸºå› çš„è¡¨è¾¾çš„å°æç´å›¾ï¼Œfig.9.L</span>
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="s">&#39;cell_chat_Vlnplot_MIF&#39;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">7</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="m">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">plotGeneExpression</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">cellchat</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">  <span class="n">signaling</span> <span class="o">=</span> <span class="s">&#34;MIF&#34;</span><span class="p">,</span> <span class="c1">#æŒ‡å®šä¸€æ¡ä¿¡å·é€šè·¯</span>
</span></span><span class="line"><span class="cl">  <span class="n">enriched.only</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> <span class="c1">#åªæ˜¾ç¤ºæ˜¾è‘—ä¸Šè°ƒçš„åŸºå› </span>
</span></span><span class="line"><span class="cl">  <span class="n">type</span> <span class="o">=</span> <span class="s">&#34;violin&#34;</span> <span class="c1">#ç»˜åˆ¶å°æç´å›¾</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#è®¡ç®—ä¿¡å·ç½‘ç»œä¸­å„ç»†èƒç¾¤ä½“çš„ä¸­å¿ƒæ€§æŒ‡æ ‡ï¼ˆå¦‚åº¦æ•°ã€ä»‹æ•°å’Œæ¥è¿‘ä¸­å¿ƒæ€§ç­‰ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="n">cellchat</span> <span class="o">&lt;-</span> <span class="nf">netAnalysis_computeCentrality</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">cellchat</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">  <span class="n">slot.name</span> <span class="o">=</span> <span class="s">&#34;netP&#34;</span> <span class="c1">#æŒ‡å®šæ•°æ®æ¥æºä¸ºæ¦‚ç‡åŠ æƒä¿¡å·ç½‘ç»œnetP</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#ç»˜åˆ¶å›¾åƒï¼Œå¯è§†åŒ–åœ¨è¯¥é€šè·¯ä¸‹æ¯ä¸ªç»†èƒçš„ä½œç”¨å¦‚ä½•ï¼Œåˆ†ä¸ºSenderã€Receiverã€Mediatorå’ŒInfluencerï¼Œfig.9.M</span>
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="s">&#39;SignalingRole_heatmap.pdf&#39;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">7</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="m">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">netAnalysis_signalingRole_network</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">cellchat</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">  <span class="n">signaling</span> <span class="o">=</span> <span class="n">pathways.show</span><span class="p">,</span> <span class="c1">#æŒ‡å®šç»˜å›¾çš„ä¿¡å·é€šè·¯ï¼Œè¿™é‡Œæ˜¯MIF</span>
</span></span><span class="line"><span class="cl">  <span class="n">width</span> <span class="o">=</span> <span class="m">8</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">  <span class="n">height</span> <span class="o">=</span> <span class="m">2.5</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">  <span class="n">font.size</span> <span class="o">=</span> <span class="m">10</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#ç”Ÿæˆçƒ­å›¾ï¼Œå±•ç¤ºæ¯ä¸ªç»†èƒç¾¤ä½“åœ¨ä¿¡å·ç½‘ç»œä¸­ä½œä¸ºå‘é€è€…ï¼ˆSenderï¼‰å’Œæ¥æ”¶è€…ï¼ˆReceiverï¼‰çš„èƒ½åŠ›ï¼Œfig.9.N</span>
</span></span><span class="line"><span class="cl"><span class="n">ht1</span> <span class="o">&lt;-</span> <span class="nf">netAnalysis_signalingRole_heatmap</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">cellchat</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">  <span class="n">pattern</span> <span class="o">=</span> <span class="s">&#34;outgoing&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ht2</span> <span class="o">&lt;-</span> <span class="nf">netAnalysis_signalingRole_heatmap</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">cellchat</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">  <span class="n">pattern</span> <span class="o">=</span> <span class="s">&#34;incoming&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="s">&#39;O_R_heatmap.pdf&#39;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">12</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="m">7</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ht1</span><span class="o">+</span><span class="n">ht2</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">NMF</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">ggalluvial</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">###outgoing###</span>
</span></span><span class="line"><span class="cl"><span class="c1">#æœ‰ä¸¤ä¸ªå‚æ•°ï¼š</span>
</span></span><span class="line"><span class="cl"><span class="c1">#Copheneticç›¸å…³ç³»æ•°ï¼Œç”¨äºè¡¡é‡æ•°æ®åœ¨èšç±»æ—¶çš„ä¿çœŸåº¦ï¼ˆfidelityï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="c1">#Silhouetteç³»æ•°è¡¡é‡æ¯ä¸ªç‚¹åœ¨èšç±»ä¸­çš„ç´§å¯†åº¦å’Œèšç±»ä¹‹é—´çš„åˆ†ç¦»åº¦</span>
</span></span><span class="line"><span class="cl"><span class="n">K</span> <span class="o">&lt;-</span> <span class="nf">selectK</span><span class="p">(</span><span class="n">cellchat</span><span class="p">,</span> <span class="n">pattern</span> <span class="o">=</span> <span class="s">&#34;outgoing&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="s">&#39;K_out.pdf&#39;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">12</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="m">7</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">K</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#ç»˜åˆ¶èšç±»çƒ­å›¾ï¼Œfig.9.O</span>
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="s">&#39;CommuPattern_out.pdf&#39;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">12</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="m">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">nPatterns</span> <span class="o">=</span> <span class="m">3</span>
</span></span><span class="line"><span class="cl"><span class="n">cellchat</span> <span class="o">&lt;-</span> <span class="nf">identifyCommunicationPatterns</span><span class="p">(</span><span class="n">cellchat</span><span class="p">,</span> <span class="n">pattern</span> <span class="o">=</span> <span class="s">&#34;outgoing&#34;</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">nPatterns</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1">#èšç±»-riverplot-outï¼Œfig.9.P</span>
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="s">&#39;riverplot_out.pdf&#39;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">12</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="m">7</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">netAnalysis_river</span><span class="p">(</span><span class="n">cellchat</span><span class="p">,</span> <span class="n">pattern</span> <span class="o">=</span> <span class="s">&#34;outgoing&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#èšç±»-dotplot-outï¼Œfig.9.Q</span>
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="s">&#39;dotplot_out.pdf&#39;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">12</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="m">7</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">netAnalysis_dot</span><span class="p">(</span><span class="n">cellchat</span><span class="p">,</span> <span class="n">pattern</span> <span class="o">=</span> <span class="s">&#34;outgoing&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">###incoming###</span>
</span></span><span class="line"><span class="cl"><span class="n">K</span> <span class="o">&lt;-</span> <span class="nf">selectK</span><span class="p">(</span><span class="n">cellchat</span><span class="p">,</span> <span class="n">pattern</span> <span class="o">=</span> <span class="s">&#34;incoming&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="s">&#39;K_in.pdf&#39;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">12</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="m">7</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">K</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#èšç±»çƒ­å›¾ï¼Œfig.9.R</span>
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="s">&#39;CommuPattern_in.pdf&#39;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">12</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="m">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">nPatterns</span> <span class="o">=</span> <span class="m">3</span>
</span></span><span class="line"><span class="cl"><span class="n">cellchat</span> <span class="o">&lt;-</span> <span class="nf">identifyCommunicationPatterns</span><span class="p">(</span><span class="n">cellchat</span><span class="p">,</span> <span class="n">pattern</span> <span class="o">=</span> <span class="s">&#34;incoming&#34;</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">nPatterns</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#èšç±»-riverplot-inï¼Œfig.9.S</span>
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="s">&#39;riverplot_in.pdf&#39;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">12</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="m">7</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">netAnalysis_river</span><span class="p">(</span><span class="n">cellchat</span><span class="p">,</span> <span class="n">pattern</span> <span class="o">=</span> <span class="s">&#34;incoming&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#èšç±»-dotplot-inï¼Œfig.9.T</span>
</span></span><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="s">&#39;dotplot_in.pdf&#39;</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="m">12</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="m">7</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">netAnalysis_dot</span><span class="p">(</span><span class="n">cellchat</span><span class="p">,</span> <span class="n">pattern</span> <span class="o">=</span> <span class="s">&#34;incoming&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="åŸºäºmonocle3çš„æ‹Ÿæ—¶åºåˆ†æ">åŸºäºMonocle3çš„æ‹Ÿæ—¶åºåˆ†æ
</h2><h3 id="è¯´æ˜-10">è¯´æ˜
</h3><h3 id="ä»£ç -10">ä»£ç 
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-R" data-lang="R"></code></pre></td></tr></table>
</div>
</div>
</section>


    <footer class="article-footer">
    

    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI&#43;WdtXRGWt2kTvGFasHpSy3SV"crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG&#43;vnGctmUb0ZY0l8"crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"integrity="sha384-&#43;VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4&#43;/RRE05"crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.body, {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ],
            ignoredClasses: ["gist"]
        });})
</script>
    
</article>

    

    

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2024 é³•é±¼
    </section>
    
    <section class="powerby">
        
            welcome to my blog <br/>
        ä½¿ç”¨ <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> æ„å»º <br />
        ä¸»é¢˜ <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.29.0">Stack</a></b> ç”± <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> è®¾è®¡
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>
<script src=https://Detarame-ding.github.io/background/sakura.js></script>

    </body>
</html>
