[{"content":" 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 #用Read10X函数读取肿瘤样本的单细胞数据 scRNA_data_t \u0026lt;- Read10X(data.dir=\u0026#34;.\\\\tumor\u0026#34;) #Read10X函数要求文件夹里有三个文件：barcodes.tsv.tz、features.tsv.tz、matrix.mtx.tz，名字必须一致 #这三个文件分别是单细胞的barcode、单细胞的注释信息以及表达矩阵 #读取的表达矩阵是用稀疏矩阵进行存储以节省空间,若想转为普通矩阵可以用as(x,\u0026#34;sparseMatrix\u0026#34;)进行转换 #查看log2x的分布情况，x是基因表达量，见fig.1A pdf(file=\u0026#34;hist1.pdf\u0026#34;,width = 5, height = 5) p = hist(log2(scRNA_data_t@x),breaks=100) dev.off() #得到该样本的基因名列表和细胞名列表 t_gene \u0026lt;- dimnames(scRNA_data_t)[[1]] t_cell \u0026lt;- dimnames(scRNA_data_t)[[2]] #构建metadata,即样本的注释信息 metadata_t = data.frame(row.names = t_cell) %\u0026gt;% mutate(sample = \u0026#39;GSE224679\u0026#39;, type = \u0026#39;Tumor\u0026#39;) #给每个细胞加上注释信息：属于GSE224679和Tumor组 #构建Seurat对象 srt1 \u0026lt;- CreateSeuratObject( counts = scRNA_data_t, #数据来源是用Read10X函数读入的scRNA_data_t meta.data = metadata_t, #指定细胞注释信息 min.cells = 3, #指定基因必须在3个及以上细胞中检测到 min.features = 200 #每个细胞至少表达200个基因才会被保留 ) #查看原始的counts矩阵 srt1@assays[[\u0026#39;RNA\u0026#39;]]@layers[[\u0026#39;counts\u0026#39;]] #V5中Seurat对象结构有改动，与以前的方法不一样 #提取基因名称 features = srt1@assays[[\u0026#39;RNA\u0026#39;]]@features features \u0026lt;- dimnames(features)[[1]] #读取normal文件夹的数据 scRNA_data_n \u0026lt;- Read10X(data.dir=\u0026#34;.\\\\normal\u0026#34;) pdf(file=\u0026#34;hist2.pdf\u0026#34;,width = 5, height = 5) hist(log2(scRNA_data_n@x),breaks=100) #fig.1B dev.off() n_gene \u0026lt;- dimnames(scRNA_data_n)[[1]] n_cell \u0026lt;- dimnames(scRNA_data_n)[[2]] metadata_n = data.frame(row.names = n_cell) %\u0026gt;% mutate(sample = \u0026#39;GSE224679\u0026#39;, type = \u0026#39;Normal\u0026#39;) srt2 \u0026lt;- CreateSeuratObject(counts = scRNA_data_n, meta.data = metadata_n, min.cells = 3, min.features = 200) #合并二个Seurat对象并保存 sc_merged \u0026lt;- merge(srt1,srt2) pbmc \u0026lt;- sc_merged save(pbmc,file=\u0026#34;merged_raw_counts.rda\u0026#34;) #查看pbmc中count和feature的分布情况 pdf(file=\u0026#34;nCount_RNA.pdf\u0026#34;,width = 5, height = 5) #统计每个细胞中测到的count总和的频数分布，fig1.C hist(pbmc$nCount_RNA) dev.off() pdf(file=\u0026#34;nFeature_RNA.pdf\u0026#34;,width = 5, height = 5) #统计每个细胞中有表达的基因的数量的频数分布，fig.1.D hist(pbmc$nFeature_RNA) dev.off() ","date":"2024-12-13T10:39:03+08:00","permalink":"https://Detarame-ding.github.io/p/02%E8%AF%BB%E5%8F%96%E6%95%B0%E6%8D%AE%E5%B9%B6%E6%9E%84%E5%BB%BAseurat%E5%AF%B9%E8%B1%A1/","title":"02读取数据并构建Seurat对象"},{"content":"#关于数据的准备\n1 2 3 4 5 6 7 8 9 10 #在https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE224679下载GSM7029397_103_23_barcodes.tsv.gz、GSM7029397_103_23_features.tsv.gz、GSM7029397_103_23_matrix.mtx.gz；GSM7029398_103_26_barcodes.tsv.gz、GSM7029398_103_26_features.tsv.gz、GSM7029398_103_26_matrix.mtx.gz六个文件。 if (!require(Seurat)){ BiocManager::install(\u0026#34;Seurat\u0026#34;) } library(Seurat) library(dplyr) library(ggplot2) library(ggsci) library(ggrepel) setwd(\u0026#34;D:\\\\windowsdownload\\\\scRNA\u0026#34;)#将下载好的文件放于此处，前三个文件放于tumor文件夹，后三个放于normal文件夹 ","date":"2024-12-12T20:10:43+08:00","permalink":"https://Detarame-ding.github.io/p/01%E6%95%B0%E6%8D%AE%E9%9B%86%E7%9A%84%E5%87%86%E5%A4%87/","title":"01数据集的准备"},{"content":"正文测试 而这些并不是完全重要，更加重要的问题是， 带着这些问题，我们来审视一下学生会退会。 既然如何， 对我个人而言，学生会退会不仅仅是一个重大的事件，还可能会改变我的人生。 我们不得不面对一个非常尴尬的事实，那就是， 可是，即使是这样，学生会退会的出现仍然代表了一定的意义。 学生会退会，发生了会如何，不发生又会如何。 经过上述讨论， 生活中，若学生会退会出现了，我们就不得不考虑它出现了的事实。 学生会退会，到底应该如何实现。 这样看来， 在这种困难的抉择下，本人思来想去，寝食难安。 对我个人而言，学生会退会不仅仅是一个重大的事件，还可能会改变我的人生。 就我个人来说，学生会退会对我的意义，不能不说非常重大。 莎士比亚曾经提到过，人的一生是短的，但如果卑劣地过这一生，就太长了。这似乎解答了我的疑惑。 莫扎特说过一句富有哲理的话，谁和我一样用功，谁就会和我一样成功。这启发了我， 对我个人而言，学生会退会不仅仅是一个重大的事件，还可能会改变我的人生。 学生会退会，到底应该如何实现。 一般来说， 从这个角度来看， 这种事实对本人来说意义重大，相信对这个世界也是有一定意义的。 在这种困难的抉择下，本人思来想去，寝食难安。 了解清楚学生会退会到底是一种怎么样的存在，是解决一切问题的关键。 一般来说， 生活中，若学生会退会出现了，我们就不得不考虑它出现了的事实。 问题的关键究竟为何？ 而这些并不是完全重要，更加重要的问题是。\n奥斯特洛夫斯基曾经说过，共同的事业，共同的斗争，可以使人们产生忍受一切的力量。　带着这句话，我们还要更加慎重的审视这个问题： 一般来讲，我们都必须务必慎重的考虑考虑。 既然如此， 这种事实对本人来说意义重大，相信对这个世界也是有一定意义的。 带着这些问题，我们来审视一下学生会退会。 我认为， 我认为， 在这种困难的抉择下，本人思来想去，寝食难安。 问题的关键究竟为何？ 每个人都不得不面对这些问题。 在面对这种问题时， 要想清楚，学生会退会，到底是一种怎么样的存在。 我认为， 既然如此， 每个人都不得不面对这些问题。 在面对这种问题时， 那么， 我认为， 学生会退会因何而发生。\n引用 思念是最暖的忧伤像一双翅膀\n让我停不了飞不远在过往游荡\n不告而别的你 就算为了我着想\n这么沉痛的呵护 我怎么能翱翔\n最暖的憂傷 - 田馥甄\n图片 1 2 3 ![Photo by Florian Klauer on Unsplash](florian-klauer-nptLmg6jqDo-unsplash.jpg) ![Photo by Luca Bravo on Unsplash](luca-bravo-alS7ewQ41M8-unsplash.jpg) ![Photo by Helena Hertz on Unsplash](helena-hertz-wWZzXlDpMog-unsplash.jpg) ![Photo by Hudai Gayiran on Unsplash](hudai-gayiran-3Od_VKcDEAA-unsplash.jpg) 相册语法来自 Typlog\n","date":"2020-09-09T00:00:00Z","image":"https://Detarame-ding.github.io/p/test-chinese/helena-hertz-wWZzXlDpMog-unsplash_hu4699868770670889127.jpg","permalink":"https://Detarame-ding.github.io/p/test-chinese/","title":"Chinese Test"}]